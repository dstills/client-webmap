import{f$ as G,q2 as Ie,fg as Oe,fc as mt,mF as B,fT as ae,E as y,F as m,J as ue,a3 as lt,du as ce,eV as Tt,aW as Fe,cX as De,xC as Ve,sC as Ce,br as Ge,by as We,pX as Ze,kG as Be,g2 as L,eZ as le,fP as M,eL as l,fe as X,fx as ht,fw as Lt,fu as ut,fv as W,ei as Je,o6 as tt,xD as Xe,eK as H,iS as b,eX as E,f4 as v,xE as Ye,wI as ct,fR as $t,xF as Mt,xG as he,f0 as jt,xH as fe,fQ as zt,eI as ft,xI as Pt,wH as Ue,ft as Ke,ld as pe,xJ as Qe,xK as tn,f8 as de,xL as ge,A as en,v as nn,f7 as rn,xM as sn,xN as on,eJ as an,wW as un,xO as cn,ue as ln,xP as hn,nD as ye,xQ as fn,f5 as pn,xR as dn,xS as gn,xT as yn,f1 as mn,xU as Ln,fm as $n,G as xn,eG as pt,co as qt,xV as vn,xW as Nn,cv as wn,xX as En}from"./index-D2dWKXoe.js";import{b as dt,j as Ht,z as It,A as Rt}from"./geodesicUtils-0BUrW_mO.js";import{j as N,d as bn}from"./geometry2dUtils-14ZJrqSH.js";import{y as me,l as Q}from"./quantityUtils-D4B7S4Ay.js";function An(e,t,n){return G(e,t,n)}function vr(e){return e}function Nr(e){return e}function Y(e,t,n){return G(e,t,n)}function U(e){return B(e)}function Yt(e,t,{coordinateHelper:n,elevationInfo:r}){return e?Tn(n.vectorToDehydratedPoint(e,Mn),t,r):null}function Tn(e,t,n){if(e==null)return null;if(t==null)return G(e.x,e.y,e.z??0);if(t.type==="2d")return G(e.x,e.y,0);const r=Ie(t,e,n,ae)??0;return G(e.x,e.y,r)}function wr(e,t){return mt(e[0],e[1],e[2],t)}function Er(e,t,{z:n,m:r},s){const{spatialReference:i,elevationInfo:a}=s;let o;n==null&&r==null?o=void 0:t==null||t.type==="2d"?o=n??void 0:o=Oe(t,e,i,ae,a)??0;const u=mt(e[0],e[1],o,i);return r!=null&&(u.m=r,u.hasM=!0),u}const Mn=mt(0,0,0,null);let S=class extends ce{constructor(){super(...arguments),this.enabled=!0}};y([m({type:Boolean})],S.prototype,"enabled",void 0),S=y([ue("esri.views.interactive.snapping.Settings.DefaultSnappingAlgorithm")],S);let g=class extends ce{constructor(e){super(e),this.lineSnapper=new S,this.parallelLineSnapper=new S,this.rightAngleSnapper=new S,this.rightAngleTriangleSnapper=new S,this.shortLineThreshold=15,this.distance=5,this.pointThreshold=1e-6,this.intersectionParallelLineThreshold=1e-6,this.parallelLineThreshold=1e-6,this.verticalLineThresholdMeters=.3,this.touchSensitivityMultiplier=1.5,this.pointOnLineThreshold=1e-6,this.orange=new lt([255,127,0]),this.orangeTransparent=new lt([255,127,0,.5]),this.lineHintWidthReference=3,this.lineHintWidthTarget=3,this.lineHintFadedExtensions=.3,this.parallelLineHintWidth=2,this.parallelLineHintLength=24,this.parallelLineHintOffset=1.5,this.rightAngleHintSize=24,this.rightAngleHintOutlineSize=1.5,this.satisfiesConstraintScreenThreshold=1}};y([m({type:S,constructOnly:!0,nonNullable:!0,json:{write:!0}})],g.prototype,"lineSnapper",void 0),y([m({type:S,constructOnly:!0,nonNullable:!0,json:{write:!0}})],g.prototype,"parallelLineSnapper",void 0),y([m({type:S,constructOnly:!0,nonNullable:!0,json:{write:!0}})],g.prototype,"rightAngleSnapper",void 0),y([m({type:S,constructOnly:!0,nonNullable:!0,json:{write:!0}})],g.prototype,"rightAngleTriangleSnapper",void 0),y([m({type:Number,nonNullable:!0,range:{min:-1,max:50,step:1},json:{write:!0}})],g.prototype,"shortLineThreshold",void 0),y([m({type:Number,nonNullable:!0,range:{min:-1,max:50,step:1},json:{write:!0}})],g.prototype,"distance",void 0),y([m({type:Number,nonNullable:!0,range:{min:0,max:1e-5},json:{write:!0}})],g.prototype,"pointThreshold",void 0),y([m({type:Number,nonNullable:!0,range:{min:0,max:1e-5},json:{write:!0}})],g.prototype,"intersectionParallelLineThreshold",void 0),y([m({type:Number,nonNullable:!0,range:{min:0,max:1e-5},json:{write:!0}})],g.prototype,"parallelLineThreshold",void 0),y([m({type:Number,nonNullable:!0,range:{min:0,max:1},json:{write:!0}})],g.prototype,"verticalLineThresholdMeters",void 0),y([m({type:Number,nonNullable:!0,range:{min:0,max:10},json:{write:!0}})],g.prototype,"touchSensitivityMultiplier",void 0),y([m({type:Number,nonNullable:!0,range:{min:0,max:1e-5},json:{write:!0}})],g.prototype,"pointOnLineThreshold",void 0),y([m({type:lt,nonNullable:!0})],g.prototype,"orange",void 0),y([m({type:lt,nonNullable:!0})],g.prototype,"orangeTransparent",void 0),y([m({type:Number,nonNullable:!0,range:{min:0,max:10},json:{write:!0}})],g.prototype,"lineHintWidthReference",void 0),y([m({type:Number,nonNullable:!0,range:{min:0,max:10},json:{write:!0}})],g.prototype,"lineHintWidthTarget",void 0),y([m({type:Number,nonNullable:!0,range:{min:0,max:1},json:{write:!0}})],g.prototype,"lineHintFadedExtensions",void 0),y([m({type:Number,nonNullable:!0,range:{min:0,max:10},json:{write:!0}})],g.prototype,"parallelLineHintWidth",void 0),y([m({type:Number,nonNullable:!0,range:{min:0,max:50},json:{write:!0}})],g.prototype,"parallelLineHintLength",void 0),y([m({type:Number,nonNullable:!0,range:{min:0,max:5},json:{write:!0}})],g.prototype,"parallelLineHintOffset",void 0),y([m({type:Number,nonNullable:!0,range:{min:0,max:46},json:{write:!0}})],g.prototype,"rightAngleHintSize",void 0),y([m({type:Number,nonNullable:!0,range:{min:0,max:6},json:{write:!0}})],g.prototype,"rightAngleHintOutlineSize",void 0),y([m({type:Number,nonNullable:!0,range:{min:0,max:5},json:{write:!0}})],g.prototype,"satisfiesConstraintScreenThreshold",void 0),g=y([ue("esri.views.interactive.snapping.Settings.Defaults")],g);const Ar=new g;var K;(function(e){e[e.FEATURE=1]="FEATURE",e[e.SELF=2]="SELF",e[e.ALL=3]="ALL"})(K||(K={}));const Tr={redo:"r",undo:"z",center:"Alt",constraint:"Shift",cancel:"Escape",delete:["Backspace","Delete"],complete:"Enter",vertexAdd:"f",pan:" "},Ut={toggle:"Control"},Mr={enterInputMode:"Tab",commit:"Enter",discard:"Escape",next:"Tab"};function Pn(e,t){const n=e.x-t.x,r=e.y-t.y;return n*n+r*r}function Pr(e,t){return Math.sqrt(Pn(e,t))}function Rr(e,t){t.sort((n,r)=>Tt(n.targetPoint,e)-Tt(r.targetPoint,e))}var Kt;function Sr({point:e,distance:t,returnEdge:n,vertexMode:r,coordinateHelper:{spatialReference:s},filter:i},a,o){return o=o!=null?o.clone():new Fe({where:"1=1"}),i&&(o.geometry=i.geometry,o.distance=i.distance,o.spatialRelationship=i.spatialRelationship,o.where=De(o.where,i.where),o.timeExtent=Ve(o.timeExtent,i.timeExtent),o.objectIds=Rn(o.objectIds,i.objectIds)),{point:mt(e[0],e[1],e[2],s.toJSON()),mode:a,distance:t,returnEdge:n,vertexMode:r,query:o.toJSON()}}function Rn(e,t){return e||t?t?e?Array.from(Ce(new Set(e),new Set(t))):t:e:null}function kr(e,t,n){return{left:Yt(e.leftVertex.pos,t,n),right:Yt(e.rightVertex.pos,t,n)}}function _r(e){return e.createQuery()}(function(e){e[e.TARGET=0]="TARGET",e[e.REFERENCE=1]="REFERENCE",e[e.REFERENCE_EXTENSION=2]="REFERENCE_EXTENSION"})(Kt||(Kt={}));const Qt=Symbol("snapping-toggle");function jr(e,t=()=>{}){const n=Ge(()=>({view:e.view,snappingOptions:e.snappingOptions}),({view:r,snappingOptions:s})=>{if(e.removeHandles(Qt),!r||!s)return;const i=Be.TOOL,a=[r.on("key-down",o=>{o.key!==Ut.toggle||o.repeat||(s.enabledToggled=!0,t())},i),r.on("key-up",o=>{o.key===Ut.toggle&&(s.enabledToggled=!1,t())},i),r.on("pointer-move",o=>{const u=o.native.ctrlKey;s.enabledToggled!==u&&(s.enabledToggled=u,t())},i)];e.addHandles(a,Qt)},We);e.addHandles(n)}function zr(e){var t;return Ze(e)&&"utilityNetworks"in e&&!!((t=e.utilityNetworks)!=null&&t.length)}let xt=class{constructor(t,n){this.isDraped=t,this.domain=n}};class Le extends xt{constructor(t,n,r=K.ALL){super(n,r),this.intersectionPoint=t}equals(t){return t instanceof Le&&L(this.intersectionPoint,t.intersectionPoint)}}class $e extends xt{constructor(t,n,r,s,i=K.ALL,a=!0,o=!0){super(s,i),this.type=t,this.lineStart=n,this.lineEnd=r,this.fadeLeft=a,this.fadeRight=o}equals(t){return t instanceof $e&&this.type===t.type&&L(this.lineStart,t.lineStart)&&L(this.lineEnd,t.lineEnd)&&this.fadeLeft===t.fadeLeft&&this.fadeRight===t.fadeRight}get length(){return le(this.lineStart,this.lineEnd)}}let Hr=class xe extends xt{constructor(t,n,r,s=K.ALL){super(r,s),this.lineStart=t,this.lineEnd=n}equals(t){return t instanceof xe&&L(this.lineStart,t.lineStart)&&L(this.lineEnd,t.lineEnd)}};class ve extends xt{constructor(t,n,r,s,i=K.ALL){super(s,i),this.previousVertex=t,this.centerVertex=n,this.nextVertex=r}equals(t){return t instanceof ve&&L(this.previousVertex,t.previousVertex)&&L(this.centerVertex,t.centerVertex)&&L(this.nextVertex,t.nextVertex)}}function Ot({start:e,end:t,type:n},r,s){const i=[],a=X(et,t,e),o=X(vt,e,r),u=ht(a),c=2*Lt(a,o),f=c*c-4*u*(ht(o)-s*s);if(f===0){const h=-c/(2*u);(n===A.PLANE||h>=0)&&i.push(ut(W(),e,a,h))}else if(f>0){const h=Math.sqrt(f),$=(-c+h)/(2*u);(n===A.PLANE||$>=0)&&i.push(ut(W(),e,a,$));const p=(-c-h)/(2*u);(n===A.PLANE||p>=0)&&i.push(ut(W(),e,a,p))}return i}function Ne(e,t){const n=e.start,r=e.end,s=X(et,r,n),i=H(wt,-s[1],s[0],0),a=t.start,o=t.end,u=b(Dt,o,a),c=E(u,i),f=H(Re,n[0],n[1],0),h=b(Se,f,a),$=E(h,i),p=tt();if(Math.abs(c)<p)return[];const x=v(ke,a,u,$/c);if(t.type===N.RAY){const w=b(St,x,a);if(E(w,u)<-p)return[]}if(e.type===A.HALF_PLANE){const w=Ye(vt,x,n);if(Lt(w,s)<-p)return[]}return[B(x)]}function Sn(e,t){return _n(gt(Vt,t[2],e),t)}function we(e,t){return Me(gt(Vt,0,e),gt(Hn,0,t)).map(([r,s])=>ct(r,s))}function Ee(e,t){return Ae(e,gt(Vt,e[2],t))}function be(e,t,n){const r=X(et,e,t),s=Ke(r),i=s===0?1:n/s,a=l();return ut(a,t,r,i),a[2]=e[2],a}function Ae(e,{start:t,end:n,type:r},s=l()){const i=b(Nt,e,t),a=b(wt,n,t),o=E(i,a)/E(a,a);return v(s,t,a,r===N.RAY?Math.max(o,0):o)}const kn=(()=>{const e=l(),t=l(),n=l();return({start:r,end:s},{center:i,radius:a,normal:o,slicePlane:u})=>{const c=$t(i,o,qn);if(d(Mt(c,r),0)&&d(Mt(c,s),0)){he(o,e,t);const h=(x,w)=>(zt(n,w,i),pe(x,E(n,e),E(n,t)),x),$=bn({start:h(et,r),end:h(vt,s),type:N.LINE},Qe,a),p=[];for(const[x,w]of $){const T=jt(l(),i);v(T,T,e,x),v(T,T,t,w),u&&!Z(u,T)||p.push(T)}return p}const f=l();return fe(c,r,s,f)?!d(le(f,i),a)||u&&!Z(u,f)?[]:[f]:[]}})();function Te({start:e,end:t,type:n},r,s){const i=[],a=zt(Nt,t,e),o=X(vt,e,r),u=ht(a),c=2*Lt(a,o),f=c*c-4*u*(ht(o)-s*s);if(f===0){const h=-c/(2*u);(n===N.LINE||h>=0)&&i.push(v(l(),e,a,h))}else if(f>0){const h=Math.sqrt(f),$=(-c+h)/(2*u);(n===N.LINE||$>=0)&&i.push(v(l(),e,a,$));const p=(-c-h)/(2*u);(n===N.LINE||p>=0)&&i.push(v(l(),e,a,p))}return i}function Me(e,t){const n=e.start,r=e.end,s=t.start,i=t.end,a=b(Nt,r,n),o=b(wt,i,s),u=b(Dt,s,n),c=ft(Re,a,o);if(!d(E(u,c),0))return[];const f=Pt(c);if(d(f,0))return[];const h=ft(Se,u,o),$=E(h,c)/f,p=v(ke,n,a,$);if(e.type===N.RAY){const x=b(St,p,n);if(E(a,x)<-tt())return[]}if(t.type===N.RAY){const x=b(St,p,s);if(E(o,x)<-tt())return[]}return[B(p)]}function _n({start:e,end:t,type:n},r){const s=b(Nt,r,e),i=b(wt,t,e),a=ft(Dt,i,s),o=Pt(a)/Pt(i),u=tt();if(o<u)switch(n){case N.LINE:return[B(r)];case N.RAY:return E(i,s)<-u?[]:[B(r)]}return[]}function Ft(e,t,n,r){const[s,i]=e,[a,o]=n,u=a-s,c=o-i,f=u*u+c*c,h=Math.sqrt(f);if(h>t+r)return[];if(h<Math.abs(t-r))return[];if(d(h,0)&&d(t,r))return[];const $=(t*t-r*r+f)/(2*h),p=Math.sqrt(t*t-$*$),x=p*c/h,w=p*u/h,[T,J]=Ue(et,e,n,$/h);return d(x,w)?[ct(T,J)]:[ct(T+x,J-w),ct(T-x,J+w)]}function gt(e,t,{start:n,end:r,type:s}){return H(e.start,n[0],n[1],t),H(e.end,r[0],r[1],t),e.type=zn[s],e}function Pe(e,t){return d(e[2],t[2])}function d(e,t){return Je(Math.abs(e-t),0,tt())}function jn(e,t){return t.filter(n=>Z(e,n))}function Z(e,t){return Xe(e,t)}var A;(function(e){e[e.PLANE=0]="PLANE",e[e.HALF_PLANE=1]="HALF_PLANE"})(A||(A={}));const zn={[A.PLANE]:N.LINE,[A.HALF_PLANE]:N.RAY},et=W(),vt=W(),Nt=l(),wt=l(),Dt=l(),Re=l(),Se=l(),ke=l(),St=l(),qn=M(),Vt={start:l(),end:l(),type:N.LINE},Hn={start:l(),end:l(),type:N.LINE};class _{intersect(t){return I(this,t)}closestPoints(t){return[this.closestTo(t)]}}class nt extends _{constructor(t){super(),this.point=t}equals(t){return this===t||P(t)&&L(this.point,t.point)}closestTo(){return U(this.point)}}class Ct extends _{constructor(t,n,r){super(),this.start=t,this.end=n,this.lineLike={start:t,end:n,type:r}}equals(t){return this===t||j(t)&&this.lineLike.type===t.lineLike.type&&L(this.start,t.start)&&L(this.end,t.end)}closestTo(t){const n=Ae(t,this.lineLike);return n}}class _e extends Ct{constructor(t,n){super(t,n,N.LINE)}}class In extends Ct{constructor(t,n){super(t,n,N.RAY)}}class je extends _{constructor(t){super(),this.constraints=t}equals(t){return this===t||kt(t)&&nn(this.constraints,t.constraints,(n,r)=>n.equals(r))}closestTo(t){let n,r=1/0;for(const s of this.constraints){const i=s.closestTo(t),a=Tt(t,i);a<r&&(r=a,n=i)}return n?U(n):t}closestPoints(t){return this.constraints.flatMap(n=>n===this?[]:n.closestPoints(t))}}class On extends _{constructor(t,n){super(),this.center=t,this.radius=n}equals(t){return this===t||q(t)&&this.center[0]===t.center[0]&&this.center[1]===t.center[1]&&this.radius===t.radius}closestTo(t){const n=be(t,this.center,this.radius);return n}}class Gt extends _{constructor(t,n){super(),this.center=t,this.radius=n}equals(t){return this===t||F(t)&&L(this.center,t.center)&&this.radius===t.radius}closestTo(t){const n=be(t,this.center,this.radius);return n[2]=this.center[2],n}asCircle(){return new Wt(U(this.center),this.radius,Y(0,0,1))}}class Wt extends _{constructor(t,n,r,s=void 0){super(),this.center=t,this.radius=n,this.normal=r,this.slicePlane=s}equals(t){return this===t||C(t)&&L(this.center,t.center)&&L(this.normal,t.normal)&&this.radius===t.radius}closestTo(t){const{center:n,radius:r}=this;ge(this.getPlane(Fn),t,bt);const s=b(bt,bt,n),i=rn(s);if(d(i,0))return U(t);const a=r/Math.sqrt(i),o=v(l(),n,s,a),{slicePlane:u}=this;if(u&&!Z(u,o)){const c=Bt(u,this);return(c==null?void 0:c.closestTo(t))??U(t)}return o}getPlane(t=M()){return $t(this.center,this.normal,t)}}const bt=l(),Fn=M();class Dn extends _{constructor(t){super(),this.z=t}equals(t){return this===t||O(t)&&this.z===t.z}closestTo(t){return G(t[0],t[1],this.z)}getPlane(t=M()){return H(te,0,0,this.z),$t(te,fn,t)}}const te=l();class Zt extends _{constructor(t,n,r){super(),this.start=t,this.end=n,this.planeLike={start:t,end:n,type:r}}equals(t){return this===t||z(t)&&this.planeLike.type===t.planeLike.type&&L(this.start,t.start)&&L(this.end,t.end)}closestTo(t){return Ee(t,this.planeLike)}closestEndTo(t){const{start:n,end:r}=this.planeLike;return Math.sign(Lt(X(Vn,r,n),X(Cn,t,n)))>0?this.end:this.start}getPlane(t=M()){const n=jt(ee,this.end);return n[2]+=1,pn(this.start,this.end,n,t)}getSlicePlane(t=M()){const{start:n,end:r,type:s}=this.planeLike;if(s===A.PLANE)return;const i=H(ee,n[0],n[1],0),a=H(ne,r[0],r[1],0),o=zt(ne,a,i);return $t(i,o,t),t}}const Vn=W(),Cn=W(),ee=l(),ne=l();class Ir extends Zt{constructor(t,n){super(t,n,A.HALF_PLANE)}}class Or extends Zt{constructor(t,n){super(t,n,A.PLANE)}}class Gn extends _{constructor(t,n){super(),this.sphere=dn(t,n)}equals(t){return this===t||D(t)&&gn(this.sphere,t.sphere)}closestTo(t){const n=yn(this.sphere,t,l());return n}get center(){return mn(this.sphere)}get radius(){return this.sphere[3]}}class Wn extends _{constructor(t,n,r){super(),this.start=t,this.end=n,this.getZ=r,this.planeLike={start:t,end:n,type:A.PLANE}}equals(t){return this===t||yt(t)&&L(this.start,t.start)&&L(this.end,t.end)&&this.getZ===t.getZ}closestTo(t){return Yn(this,t)}addIfOnTheGround(t,n){for(const r of n){const s=this.getZ(r[0],r[1])??0;d(r[2],s)&&(r[2]=s,t.push(r))}}}class Zn extends _{constructor(t,n,r,s,i){super(),this._origin=t,this._spatialReference=n,this._distanceMeters=r,this._elevationMeters=s,this._directionDegrees=i}equals(t){return this===t||hr(t)&&Ln(this._origin,t._origin)&&this._distanceMeters===t._distanceMeters&&this._elevationMeters===t._elevationMeters&&this._directionDegrees===t._directionDegrees}closestTo([t,n,r]){if(pe(V,t,n),this._directionDegrees!=null&&this._distanceMeters!=null)dt(V,this._origin,this._directionDegrees,this._distanceMeters,this._spatialReference);else if(this._directionDegrees!=null)Jn(V,this._origin,this._directionDegrees,V,this._spatialReference);else if(this._distanceMeters!=null){const{azimuth:s}=Ht(Bn,this._origin,V,this._spatialReference);dt(V,this._origin,s??0,this._distanceMeters,this._spatialReference)}return An(V[0],V[1],this._elevationMeters??r)}}const V=[0,0],Bn=new It;function Jn(e,t,n,r,s){let{azimuth:i,distance:a}=Ht(Xn,t,r,s);i??(i=0);let o=a*Math.cos((i-n)*$n);o=Math.max(0,o),dt(e,t,n,o,s)}const Xn=new It;function Yn(e,t){const n=Ee(t,e.planeLike);return n[2]=e.getZ(n[0],n[1])??qe,n}function I(e,t){if(kt(e)){const n=[];for(const r of e.constraints){const s=r.intersect(t);s&&n.push(s)}return Jt(n)}if(kt(t))return I(t,e);if(yt(e))return re(e,t);if(yt(t))return re(t,e);if(P(e)){const{point:n}=e;if(P(t))return L(n,t.point)?e:void 0;const r=t.closestTo(n);return un(r,n)?e:void 0}if(j(e)){if(P(t))return I(t,e);if(j(t))return k(Me(e.lineLike,t.lineLike));if(O(t))return Un(e,t);if(z(t))return k(Ne(t.planeLike,e.lineLike));if(q(t))return k(Te(e.lineLike,t.center,t.radius));if(C(t))return k(kn(e.lineLike,t));if(F(t))return Kn(e,t);if(D(t))return Qn(e,t)}else if(O(e)){if(P(t)||j(t))return I(t,e);if(O(t))return tr(e,t);if(z(t))return er(e,t);if(q(t))return nr(e,t);if(C(t))return sr(e,t);if(F(t))return rr(e,t);if(D(t))return ir(e,t)}else if(z(e)){if(P(t)||j(t)||O(t))return I(t,e);if(z(t))return At(we(e.planeLike,t.planeLike));if(q(t))return At(Ot(e.planeLike,t.center,t.radius));if(C(t))return ar(e,t);if(F(t))return or(e,t);if(D(t))return ur(e,t)}else if(q(e)){if(P(t)||j(t)||O(t)||z(t))return I(t,e);if(q(t))return At(Ft(e.center,e.radius,t.center,t.radius));if(C(t))return void 0;if(F(t))return cr(e,t);if(D(t))return void 0}else if(C(e)){if(P(t)||j(t)||O(t)||z(t)||q(t))return I(t,e);if(C(t))return void 0;if(F(t))return t.asCircle(),void 0;if(D(t))return void 0}else if(F(e)){if(P(t)||j(t)||O(t)||z(t)||q(t)||C(t))return I(t,e);if(F(t))return lr(t,e);if(D(t))return void 0}else if(D(e)){if(P(t)||j(t)||O(t)||z(t)||q(t)||F(t))return I(t,e);if(D(t))return void 0}}const Un=(()=>{const e=M();return(t,n)=>{const{start:r,end:s}=t;if(Pe(r,s)&&d(r[2],n.z))return t;const i=l();return fe(n.getPlane(e),r,s,i)?new nt(i):void 0}})();function Kn({lineLike:e},{center:t,radius:n}){const r=t[2];return k(Te(e,t,n).filter(s=>d(s[2],r)))}function Qn({lineLike:e},{sphere:t}){return k(cn(t,e.start,e.end))}const Bt=(()=>{const e=ln(),t=l(),n=l();return(r,s,i)=>{const{normal:a,center:o,radius:u}=s;he(a,t,n);const c=de(r),f=u*E(c,t),h=u*E(c,n);sn(e,o[0],o[1],o[2],1);const $=on(r,e),p=Math.hypot(f,h),x=d(p,0);if(d(Mt(r,o),0)){if(x)return s;if(d(u,0))return!i||Z(i,o)?new nt(U(o)):void 0;ft(t,c,a),an(t,t);const Et=new Array,ot=B(o);v(ot,ot,t,u),i&&!Z(i,ot)||Et.push(ot);const at=B(o);return v(at,at,t,-u),i&&!Z(i,at)||Et.push(at),k(Et)}if(x)return;const w=-$/p;if(Math.abs(w)>1||d(w,1))return;const T=Math.atan(f/h),J=hn(w)-T,Xt=Math.PI-J,rt=new Array,st=l();v(st,o,t,u*Math.cos(J)),v(st,st,n,u*Math.sin(J)),rt.push(st);const it=l();return v(it,o,t,u*Math.cos(Xt)),v(it,it,n,u*Math.sin(Xt)),rt.push(it),k(i?jn(i,rt):rt)}})();function tr(e,t){return d(e.z,t.z)?e:void 0}function er({z:e},{planeLike:t}){const[n,r]=t.start,[s,i]=t.end,a=Y(n,r,e),o=Y(s,i,e);return t.type===A.PLANE?new _e(a,o):new In(a,o)}function nr(e,t){const[n,r]=t.center;return new Gt(Y(n,r,e.z),t.radius)}function rr(e,t){return d(t.center[2],e.z)?t:void 0}const sr=(()=>{const e=M();return(t,n)=>Bt(t.getPlane(e),n,n.slicePlane)})();function ir(e,{center:t,radius:n}){const r=Math.abs(t[2]-e.z);if(r>n&&!d(r,n))return;const s=Y(t[0],t[1],e.z),i=Math.sqrt(n**2-r**2);return d(i,0)?void 0:new Gt(s,i)}const or=(()=>{const e=M();return(t,{center:n,radius:r})=>{const s=Ot(t.planeLike,n,r),i=n[2];t.getSlicePlane(e);const a=new Array;for(const[o,u]of s){const c=[o,u,i];Z(e,c)&&a.push(c)}return k(a)}})(),ar=(()=>{const e=M(),t=M();return(n,r)=>Bt(n.getPlane(e),r,n.getSlicePlane(t))})(),ur=(()=>{const e=M();return(t,{center:n,radius:r})=>{const s=t.getPlane(e),i=tn(s,n),a=Math.abs(i);if(a>r&&!d(a,r))return;const o=B(de(s)),u=v(l(),n,o,i),c=Math.sqrt(r**2-i**2);return d(c,0)?new nt(ge(s,n,l())):new Wt(u,c,o,t.getSlicePlane())}})();function cr(e,t){const n=ye(e.center,t.center);return d(n,0)&&d(e.radius,t.radius)?t:ze(Ft(e.center,e.radius,t.center,t.radius),t.center[2])}function lr(e,t){if(!Pe(e.center,t.center))return;const n=ye(e.center,t.center);return d(n,0)&&d(e.radius,t.radius)?e:ze(Ft(e.center,e.radius,t.center,t.radius),e.center[2])}function re(e,t){const{planeLike:n,getZ:r}=e,s=new Array;if(P(t))e.addIfOnTheGround(s,Sn(n,t.point));else if(j(t))e.addIfOnTheGround(s,Ne(n,t.lineLike));else if(q(t))for(const[i,a]of Ot(n,t.center,t.radius)){const o=r(i,a);o!=null&&s.push(G(i,a,o))}else if(z(t)||yt(t))for(const[i,a]of we(n,t.planeLike)){const o=r(i,a)??qe;s.push(G(i,a,o))}return k(s)}function At(e){return Jt(e.map(([t,n])=>{const r=Y(t,n,0),s=Y(t,n,1);return new _e(r,s)}))}function k(e){return Jt(e.map(t=>t?new nt(t):void 0))}function ze(e,t){return k(e.map(([n,r])=>[n,r,t]))}function Jt(e){if(e.length!==0)return e.length===1?e[0]??void 0:new je(e.filter(en))}function kt(e){return e instanceof je}function P(e){return e instanceof nt}function j(e){return e instanceof Ct}function O(e){return e instanceof Dn}function z(e){return e instanceof Zt}function q(e){return e instanceof On}function F(e){return e instanceof Gt}function C(e){return e instanceof Wt}function D(e){return e instanceof Gn}function yt(e){return e instanceof Wn}function hr(e){return e instanceof Zn}const qe=0;var R;function fr(e,t){if(e==null||t==null)return;const n=_t(e,t);return n!=null?Q(n,"radians","geographic"):void 0}(function(e){e.Absolute="absolute",e.Relative="relative",e.RelativeBilateral="relative-bilateral"})(R||(R={}));const _t=(()=>{const e=l(),t=l();return(n,r)=>(H(e,n.x,n.y,n.z??0),H(t,r.x,r.y,r.z??0),pr(e,t,n.spatialReference,r.spatialReference))})(),pr=(()=>{const e=W(),t=l(),n=l();return(r,s,i,a)=>{if(L(r,s))return;const o=Rt(i),u=Rt(a);if(o&&u&&xn(o,u)&&pt(r,i,t,o)&&pt(s,a,n,u)){const{azimuth:f}=Ht(dr,t,n,o);return f!=null?qt(f,"degrees","radians"):void 0}e[0]=s[0]-r[0],e[1]=s[1]-r[1];let c=vn(Nn,e);return e[0]<0&&(c=gr-c),c}})();function Fr(e,t,n,r=R.Absolute){if(t&&n)switch(r){case R.Absolute:return fr(t,n);case R.Relative:return ie(se(e,t,n),R.Relative);case R.RelativeBilateral:return ie(se(e,t,n),R.RelativeBilateral)}}function se(e,t,n){if(!e||!t||!n)return;const r=_t(e,t),s=_t(t,n);return r!=null&&s!=null?Q(s-r,"radians","geographic"):void 0}function ie(e,t){if(e==null)return;const n=He(e);switch(t){case R.Absolute:{const r=yr.normalize(n,0,!0);return Q(r,"degrees","geographic")}case R.Relative:{let r=oe.normalize(n,0,!0);return r===-180&&(r=180),Q(r,"degrees","geographic")}case R.RelativeBilateral:{const r=Math.abs(oe.normalize(n,0,!0));return Q(r,"degrees","geographic")}}}const Dr=(()=>{const e=l();return(t,n,r,s,i,a="geodesic")=>{jt(e,n);const o=He(i);if(a==="geodesic"){const p=Rt(r);if(p&&pt(e,r,e,p))return dt(t,e,o,s,p),t[2]=n[2],!!pt(t,p,t,r)}const u=me(o,"geographic","arithmetic"),c=qt(u,"degrees","radians"),f=n[0]+s*Math.cos(c),h=n[1]+s*Math.sin(c),$=n[2];return H(t,f,h,$),!0}})();function He(e){return e!=null?me(qt(e.value,e.unit,"degrees"),e.rotationType,"geographic"):void 0}const dr=new It,gr=2*Math.PI,yr=wn,oe=new En(-180,180);export{Dr as A,He as B,Wn as C,Ir as D,Kt as E,Yt as F,Pr as G,Pn as H,Or as I,kr as J,pr as K,_e as L,On as M,jr as N,Ae as O,fr as R,Dn as T,Zn as U,xt as a,Y as b,Rr as c,wr as d,Tr as e,Nr as f,K as g,Tn as h,An as i,_r as j,Er as k,vr as l,nt as m,$e as n,Le as o,Ar as p,R as q,Hr as r,ve as s,Jt as t,P as u,Mr as v,ie as w,Fr as x,Sr as y,zr as z};

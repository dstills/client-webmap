import{fD as M,fE as m,fF as x,fG as $,fH as g,fI as w,fB as N,fC as v,eL as i,fJ as y,fK as G,bW as E,fd as S,fL as P,fM as U,fN as H,fO as I,f0 as T,fP as b,eI as C,fQ as R,f8 as F,fR as h,fS as A,eX as k,eU as L,eT as q}from"./index-HSyhVbHY.js";import{Y as B}from"./InteractiveToolBase-gXNyS2rx.js";function J(e,n){return D(e,()=>n)}function ee(e){return D(e,n=>n.plane)}function D(e,n){const t=i(),l=i();let s=!1;return r=>{const o=n(r);if(r.action==="start"){const c=m(r.screenStart,x($.get())),u=g(e.state.camera,c,O);u!=null&&(s=w(o,u,t))}if(!s)return null;const a=m(r.screenEnd,x($.get())),d=g(e.state.camera,a,O);return d==null?null:w(o,d,l)?{...r,renderStart:t,renderEnd:l,plane:o,ray:d}:null}}function K(e,n,t=0,l=null,s=null){let r=null;return o=>{if(o.action==="start"&&(r=e.sceneIntersectionHelper.intersectElevationFromScreen(S(o.screenStart.x,o.screenStart.y),n,t,s),r!=null&&l!=null&&!H(r,r,l))||r==null)return null;const a=e.sceneIntersectionHelper.intersectElevationFromScreen(S(o.screenEnd.x,o.screenEnd.y),n,t,s);return a!=null&&(l==null||H(a,a,l))?{...o,mapStart:r,mapEnd:a}:null}}function j(e,n,t,l=null,s=null){return K(e,t,P(n,e,t),l,s)}function z(e,n,t,l=null,s=null){return j(e,t,U(n),l,s)}function ne(e,n,t,l){const s=n.toMap(e.screenStart,{include:[t]});return s!=null?z(n,t,s,l):null}function Q(e,n){const t=Y,l=_,s=b();e.renderCoordsHelper.worldUpAtPosition(n,t);const r=C(F(s),t,R(l,n,e.state.camera.eye));return C(r,r,t),h(n,r,s)}function te(e,n,t){let l=null;const s=new B;return s.next(J(e,Q(e,n))).next(W(e,n)).next(X(e,t)).next(r=>{r.mapEnd.x=r.mapStart.x,r.mapEnd.y=r.mapStart.y,l=r}),r=>(l=null,s.execute(r),l)}function W(e,n){const t=i(),l=I(n);e.renderCoordsHelper.worldUpAtPosition(n,t);const s=i(),r=i(),o=a=>(R(a,a,n),A(t,a,a),e.viewingMode==="global"&&I(a)*Math.sign(k(t,a))<.001-l&&R(a,L(a,t,.001),n),q(a,a,n),a);return a=>(a.renderStart=o(T(s,a.renderStart)),a.renderEnd=o(T(r,a.renderEnd)),a)}function X(e,n){const t=e.renderCoordsHelper;return l=>{const s=t.fromRenderCoords(l.renderStart,new E({spatialReference:n})),r=t.fromRenderCoords(l.renderEnd,new E({spatialReference:n}));return s!=null&&r!=null?{...l,mapStart:s,mapEnd:r}:null}}var p;function re(e){let n=null;return t=>{switch(t.action){case"start":n=e.disableDisplay();break;case"end":case"cancel":n!=null&&(n.remove(),n=null)}return t}}function le(e,n=null){const t=N(e.state.viewingMode);t.options.selectionMode=!0,t.options.store=v.MIN,t.options.hud=!1;const l=S(),s={requiresGroundFeedback:!0,enableDraped:!0,exclude:new Set},r=i(),o=n??e.spatialReference,a=c=>{e.map.ground&&e.map.ground.opacity<1?s.exclude.add(y):s.exclude.delete(y),e.sceneIntersectionHelper.intersectIntersectorScreen(m(c,l),t,s);const u=t.results.min;let f;if(u.getIntersectionPoint(r))f=u.intersector===G.TERRAIN?p.GROUND:p.OTHER;else{if(!t.results.ground.getIntersectionPoint(r))return null;f=p.GROUND}return{location:e.renderCoordsHelper.fromRenderCoords(r,new E({spatialReference:o})),surfaceType:f}};let d;return c=>{if(c.action==="start"){const f=a(c.screenStart);d=f!=null?f.location:null}if(d==null)return null;const u=a(c.screenEnd);return(u==null?void 0:u.location)!=null?{...c,mapStart:d,mapEnd:u.location,surfaceType:u.surfaceType}:null}}(function(e){e[e.GROUND=0]="GROUND",e[e.OTHER=1]="OTHER"})(p||(p={}));const Y=i(),_=i(),O=M();export{X as A,ee as C,j as D,p as F,z as M,ne as N,J as O,te as k,re as q,le as z};

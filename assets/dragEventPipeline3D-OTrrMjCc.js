import{fF as D,fG as m,fH as x,fI as $,fJ as g,fK as w,fD as M,fE as v,eN as i,fL as y,fM as G,bY as E,ff as S,fN as P,fO as U,fP as H,fQ as T,f2 as I,fR as b,eK as N,fS as R,fa as F,fT as h,fU as A,eZ as k,eW as K,eV as q}from"./index-BS4ejk0L.js";import{Y as J}from"./InteractiveToolBase-SIpBYGY-.js";function L(e,n){return C(e,()=>n)}function ee(e){return C(e,n=>n.plane)}function C(e,n){const t=i(),l=i();let s=!1;return r=>{const o=n(r);if(r.action==="start"){const c=m(r.screenStart,x($.get())),u=g(e.state.camera,c,O);u!=null&&(s=w(o,u,t))}if(!s)return null;const a=m(r.screenEnd,x($.get())),d=g(e.state.camera,a,O);return d==null?null:w(o,d,l)?{...r,renderStart:t,renderEnd:l,plane:o,ray:d}:null}}function Y(e,n,t=0,l=null,s=null){let r=null;return o=>{if(o.action==="start"&&(r=e.sceneIntersectionHelper.intersectElevationFromScreen(S(o.screenStart.x,o.screenStart.y),n,t,s),r!=null&&l!=null&&!H(r,r,l))||r==null)return null;const a=e.sceneIntersectionHelper.intersectElevationFromScreen(S(o.screenEnd.x,o.screenEnd.y),n,t,s);return a!=null&&(l==null||H(a,a,l))?{...o,mapStart:r,mapEnd:a}:null}}function j(e,n,t,l=null,s=null){return Y(e,t,P(n,e,t),l,s)}function z(e,n,t,l=null,s=null){return j(e,t,U(n),l,s)}function ne(e,n,t,l){const s=n.toMap(e.screenStart,{include:[t]});return s!=null?z(n,t,s,l):null}function B(e,n){const t=W,l=Z,s=b();e.renderCoordsHelper.worldUpAtPosition(n,t);const r=N(F(s),t,R(l,n,e.state.camera.eye));return N(r,r,t),h(n,r,s)}function te(e,n,t){let l=null;const s=new J;return s.next(L(e,B(e,n))).next(Q(e,n)).next(V(e,t)).next(r=>{r.mapEnd.x=r.mapStart.x,r.mapEnd.y=r.mapStart.y,l=r}),r=>(l=null,s.execute(r),l)}function Q(e,n){const t=i(),l=T(n);e.renderCoordsHelper.worldUpAtPosition(n,t);const s=i(),r=i(),o=a=>(R(a,a,n),A(t,a,a),e.viewingMode==="global"&&T(a)*Math.sign(k(t,a))<.001-l&&R(a,K(a,t,.001),n),q(a,a,n),a);return a=>(a.renderStart=o(I(s,a.renderStart)),a.renderEnd=o(I(r,a.renderEnd)),a)}function V(e,n){const t=e.renderCoordsHelper;return l=>{const s=t.fromRenderCoords(l.renderStart,new E({spatialReference:n})),r=t.fromRenderCoords(l.renderEnd,new E({spatialReference:n}));return s!=null&&r!=null?{...l,mapStart:s,mapEnd:r}:null}}var p;function re(e){let n=null;return t=>{switch(t.action){case"start":n=e.disableDisplay();break;case"end":case"cancel":n!=null&&(n.remove(),n=null)}return t}}function le(e,n=null){const t=M(e.state.viewingMode);t.options.selectionMode=!0,t.options.store=v.MIN,t.options.hud=!1;const l=S(),s={requiresGroundFeedback:!0,enableDraped:!0,exclude:new Set},r=i(),o=n??e.spatialReference,a=c=>{e.map.ground&&e.map.ground.opacity<1?s.exclude.add(y):s.exclude.delete(y),e.sceneIntersectionHelper.intersectIntersectorScreen(m(c,l),t,s);const u=t.results.min;let f;if(u.getIntersectionPoint(r))f=u.intersector===G.TERRAIN?p.GROUND:p.OTHER;else{if(!t.results.ground.getIntersectionPoint(r))return null;f=p.GROUND}return{location:e.renderCoordsHelper.fromRenderCoords(r,new E({spatialReference:o})),surfaceType:f}};let d;return c=>{if(c.action==="start"){const f=a(c.screenStart);d=f!=null?f.location:null}if(d==null)return null;const u=a(c.screenEnd);return(u==null?void 0:u.location)!=null?{...c,mapStart:d,mapEnd:u.location,surfaceType:u.surfaceType}:null}}(function(e){e[e.GROUND=0]="GROUND",e[e.OTHER=1]="OTHER"})(p||(p={}));const W=i(),Z=i(),O=D();export{V as A,ee as C,j as D,p as F,z as M,ne as N,L as O,te as k,re as q,le as z};

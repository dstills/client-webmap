import{j as A,bK as R,bU as S,ip as q,br as v,cE as j,iq as W}from"./index-BhDz4nJ7.js";import{j as $}from"./timeSupport-BllRBzVr.js";const B=new Float64Array(2),E=new Float64Array(2),F="0123456789bcdefghjkmnpqrstuvwxyz",K=64;function I(n,e,r,a){const t=[n.xmin,n.ymin,n.xmax,n.ymax],s=A.fromExtent(R.fromBounds(t,a)),c=$(s,a,S.WGS84,{densificationStep:e*K});if(!c)return null;const o=q(new v,c,!1,!1),f=o.coords.filter((g,m)=>!(m%2)),u=o.coords.filter((g,m)=>m%2),p=Math.min(...f),M=Math.min(...u),l=Math.max(...f),h=Math.max(...u),i=w(p,M,r,S.WGS84),y=w(l,h,r,S.WGS84);return i&&y?{bounds:t,geohashBounds:{xLL:i[0],yLL:i[1],xTR:y[0],yTR:y[1]},level:r}:null}function w(n,e,r,a){if(a.isWebMercator){const c=j(n/W.radius),o=c-360*Math.floor((c+180)/360),f=[0,0];return L(f,0,j(Math.PI/2-2*Math.atan(Math.exp(-e/W.radius))),o,r),f}const t=$({x:n,y:e},a,S.WGS84);if(!t)return null;const s=[0,0];return L(s,0,t.y,t.x,r),s}function T(n){return F[n]}function z(n){return(n[0]+n[1])/2}function G(n,e,r){return n[0]=e,n[1]=r,n}function Y(n,e){const r=z(n),a=e,t=!e;n[0]=t*n[0]+a*r,n[1]=t*r+a*n[1]}function x(n,e){const r=e>z(n);return Y(n,r),r}function P(n,e){let r=-90,a=90,t=-180,s=180;for(let c=0;c<e;c++){const o=Math.ceil((c+1)/2),f=Math.floor((c+1)/2),u=1-c%2,p=30-(3*o+2*f),M=30-(2*o+3*f),l=3*u+2*(1-u),h=2*u+3*(1-u),i=3*u+7*(1-u)<<M,y=(7*u+3*(1-u)<<p&n.geohashX)>>p,g=(i&n.geohashY)>>M;for(let m=l-1;m>=0;m--){const b=(t+s)/2,d=y&1<<m?1:0;t=(1-d)*t+d*b,s=(1-d)*b+d*s}for(let m=h-1;m>=0;m--){const b=(r+a)/2,d=g&1<<m?1:0;r=(1-d)*r+d*b,a=(1-d)*b+d*a}}return[t,r,s,a]}function L(n,e,r,a,t){t%2&&(t+=1);let s=0,c=0,o=-90,f=90,u=-180,p=180;for(let M=0;M<t/2;M++){for(let l=0;l<5;l++){const h=(u+p)/2,i=a>h?1:0;s|=i<<29-(l+5*M),u=(1-i)*u+i*h,p=(1-i)*h+i*p}for(let l=0;l<5;l++){const h=(o+f)/2,i=r>h?1:0;c|=i<<29-(l+5*M),o=(1-i)*o+i*h,f=(1-i)*h+i*f}}n[2*e]=s,n[2*e+1]=c}function U(n,e,r){let a="";const t=G(B,-90,90),s=G(E,-180,180);for(let c=0;c<r;c++){let o=0;c%2?(o|=x(t,n)<<4,o|=x(s,e)<<3,o|=x(t,n)<<2,o|=x(s,e)<<1,o|=x(t,n)<<0):(o|=x(s,e)<<4,o|=x(t,n)<<3,o|=x(s,e)<<2,o|=x(t,n)<<1,o|=x(s,e)<<0),a+=T(o)}return a}export{w as A,P as R,I as S,U as z};

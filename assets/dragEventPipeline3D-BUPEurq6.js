import{dp as O,dq as m,dr as x,ds as $,dt as g,du as w,cF as E,cS as d,dv as F,dw as G,dx as y,dj as H,dy as S,dz as C,dA as M,dl as I,dB as R,dC as N,dD as P,dE as U,dc as b,d9 as A,d8 as h,dF as k,dG as q,dH as T,dI as j}from"./index-nBWeBKPv.js";import{Y as z}from"./InteractiveToolBase-B1cmKqcL.js";function B(n,e){return D(n,()=>e)}function nn(n){return D(n,e=>e.plane)}function D(n,e){const t=d(),l=d();let s=!1;return r=>{const o=e(r);if(r.action==="start"){const c=m(r.screenStart,x($.get())),u=g(n.state.camera,c,v);u!=null&&(s=w(o,u,t))}if(!s)return null;const a=m(r.screenEnd,x($.get())),i=g(n.state.camera,a,v);return i==null?null:w(o,i,l)?{...r,renderStart:t,renderEnd:l,plane:o,ray:i}:null}}function J(n,e,t=0,l=null,s=null){let r=null;return o=>{if(o.action==="start"&&(r=n.sceneIntersectionHelper.intersectElevationFromScreen(S(o.screenStart.x,o.screenStart.y),e,t,s),r!=null&&l!=null&&!C(r,r,l))||r==null)return null;const a=n.sceneIntersectionHelper.intersectElevationFromScreen(S(o.screenEnd.x,o.screenEnd.y),e,t,s);return a!=null&&(l==null||C(a,a,l))?{...o,mapStart:r,mapEnd:a}:null}}function K(n,e,t,l=null,s=null){return J(n,t,F(e,n,t),l,s)}function L(n,e,t,l=null,s=null){return K(n,t,G(e),l,s)}function en(n,e,t,l){const s=e.toMap(n.screenStart,{include:[t]});return s!=null?L(e,t,s,l):null}function Y(n,e){const t=V,l=W,s=M();n.renderCoordsHelper.worldUpAtPosition(e,t);const r=I(N(s),t,R(l,e,n.state.camera.eye));return I(r,r,t),P(e,r,s)}function tn(n,e,t){let l=null;const s=new z;return s.next(B(n,Y(n,e))).next(_(n,e)).next(Q(n,t)).next(r=>{r.mapEnd.x=r.mapStart.x,r.mapEnd.y=r.mapStart.y,l=r}),r=>(l=null,s.execute(r),l)}function _(n,e){const t=d(),l=y(e);n.renderCoordsHelper.worldUpAtPosition(e,t);const s=d(),r=d(),o=a=>(R(a,a,e),U(t,a,a),n.viewingMode==="global"&&y(a)*Math.sign(b(t,a))<.001-l&&R(a,A(a,t,.001),e),h(a,a,e),a);return a=>(a.renderStart=o(H(s,a.renderStart)),a.renderEnd=o(H(r,a.renderEnd)),a)}function Q(n,e){const t=n.renderCoordsHelper;return l=>{const s=t.fromRenderCoords(l.renderStart,new E({spatialReference:e})),r=t.fromRenderCoords(l.renderEnd,new E({spatialReference:e}));return s!=null&&r!=null?{...l,mapStart:s,mapEnd:r}:null}}var f;function rn(n){let e=null;return t=>{switch(t.action){case"start":e=n.disableDisplay();break;case"end":case"cancel":e!=null&&(e.remove(),e=null)}return t}}function ln(n,e=null){const t=k(n.state.viewingMode);t.options.selectionMode=!0,t.options.store=q.MIN,t.options.hud=!1;const l=S(),s={requiresGroundFeedback:!0,enableDraped:!0,exclude:new Set},r=d(),o=e??n.spatialReference,a=c=>{n.map.ground&&n.map.ground.opacity<1?s.exclude.add(T):s.exclude.delete(T),n.sceneIntersectionHelper.intersectIntersectorScreen(m(c,l),t,s);const u=t.results.min;let p;if(u.getIntersectionPoint(r))p=u.intersector===j.TERRAIN?f.GROUND:f.OTHER;else{if(!t.results.ground.getIntersectionPoint(r))return null;p=f.GROUND}return{location:n.renderCoordsHelper.fromRenderCoords(r,new E({spatialReference:o})),surfaceType:p}};let i;return c=>{if(c.action==="start"){const p=a(c.screenStart);i=p!=null?p.location:null}if(i==null)return null;const u=a(c.screenEnd);return(u==null?void 0:u.location)!=null?{...c,mapStart:i,mapEnd:u.location,surfaceType:u.surfaceType}:null}}(function(n){n[n.GROUND=0]="GROUND",n[n.OTHER=1]="OTHER"})(f||(f={}));const V=d(),W=d(),v=O();export{Q as A,nn as C,K as D,f as F,L as M,en as N,B as O,tn as k,rn as q,ln as z};

import{pb as M,os as c,b as T,ap as f,aU as N,v9 as U,va as b,l4 as A,m as x,vb as B}from"./index-D2dWKXoe.js";let d=class E{constructor(t,s,r,i,n,a,o){this.instanceId=t,this.textureKey=s,this.indexStart=r,this.indexCount=i,this.vertexStart=n,this.vertexCount=a,this.overlaps=o}updateBaseOffsets(t){this.vertexStart+=t.vertexFrom,this.indexStart+=t.indexFrom}clone(){return new E(this.instanceId,this.textureKey,this.indexStart,this.indexCount,this.vertexStart,this.vertexCount,this.overlaps)}static write(t,s,r,i,n,a,o,u){t.push(s),t.push(r),t.push(i),t.push(n),t.push(a),t.push(o),t.push(u)}serialize(t){return t.push(this.instanceId),t.push(this.textureKey),t.push(this.indexStart),t.push(this.indexCount),t.push(this.vertexStart),t.push(this.vertexCount),t.push(this.overlaps),t}static deserialize(t){const s=t.readInt32(),r=t.readInt32(),i=t.readInt32(),n=t.readInt32(),a=t.readInt32(),o=t.readInt32(),u=t.readInt32();return new E(s,r,i,n,a,o,u)}};d.byteSizeHint=7*Uint32Array.BYTES_PER_ELEMENT;function I(e,t){if(t!==null){e.push(t.length);for(const s of t)s.serialize(e);return e}e.push(0)}function S(e,t,s){const r=e.readInt32(),i=new Array(r);for(let n=0;n<i.length;n++)i[n]=t.deserialize(e,s);return i}class y{constructor(t,s){this.id=t,this.sortKey=s,this.records=[]}serialize(t){return t.push(this.id),t.writeF32(this.sortKey),I(t,this.records),t}static deserialize(t){const s=t.readInt32(),r=t.readF32(),i=new y(s,r);return i.records=S(t,d)??[],i}}y.byteSizeHint=2*Uint32Array.BYTES_PER_ELEMENT+d.byteSizeHint;function k(e){const t=e.map(({name:s,count:r,type:i})=>`${s}.${r}.${i}`).join(",");return M(t)}function l(e,t,s,r,i,n,a){if(e.primitiveName===t){for(const o in e)if(o===s){let u=r==null?void 0:r.readWithDefault(i,n,e[o]&&a);return e.type==="text"&&(u=u.toString()),void(e[o]=u)}}if("type"in e&&e.type!=null)switch(e.type){case"CIMPointSymbol":case"CIMLineSymbol":case"CIMPolygonSymbol":if(e.symbolLayers)for(const o of e.symbolLayers)l(o,t,s,r,i,n,a);break;case"CIMHatchFill":e.lineSymbol&&l(e.lineSymbol,t,s,r,i,n,a);break;case"CIMSolidStroke":case"CIMSolidFill":case"CIMVectorMarker":if(e.type==="CIMVectorMarker"&&e.markerGraphics)for(const o of e.markerGraphics)l(o,t,s,r,i,n,a),l(o.symbol,t,s,r,i,n,a)}}function C(e){const t=e.width;return e.effects!=null?256:Math.max(1.25*t,8)}const Y=new Float32Array(1);new Uint32Array(Y.buffer);function z(e,t){return 65535&e|t<<16}function O(e,t,s,r){const i=s.packPrecisionFactor??1;switch(s.type){case c.BYTE:if(s.count===1)e.setInt8(r+s.offset,t*i);else for(let n=0;n<s.count;n++){const a=n*Int8Array.BYTES_PER_ELEMENT;e.setInt8(r+s.offset+a,t[n]*i)}break;case c.UNSIGNED_BYTE:if(s.count===1)e.setUint8(r+s.offset,t*i);else for(let n=0;n<s.count;n++){const a=n*Uint8Array.BYTES_PER_ELEMENT;e.setUint8(r+s.offset+a,t[n]*i)}break;case c.SHORT:if(s.count===1)e.setInt16(r+s.offset,t*i,!0);else for(let n=0;n<s.count;n++){const a=n*Int16Array.BYTES_PER_ELEMENT;e.setInt16(r+s.offset+a,t[n]*i,!0)}break;case c.UNSIGNED_SHORT:if(s.count===1)e.setUint16(r+s.offset,t*i,!0);else for(let n=0;n<s.count;n++){const a=n*Uint16Array.BYTES_PER_ELEMENT;e.setUint16(r+s.offset+a,t[n]*i,!0)}break;case c.INT:if(s.count===1)e.setInt32(r+s.offset,t*i,!0);else for(let n=0;n<s.count;n++){const a=n*Int32Array.BYTES_PER_ELEMENT;e.setInt32(r+s.offset+a,t[n]*i,!0)}break;case c.UNSIGNED_INT:if(s.count===1)e.setUint32(r+s.offset,t*i,!0);else for(let n=0;n<s.count;n++){const a=n*Uint32Array.BYTES_PER_ELEMENT;e.setUint32(r+s.offset+a,t[n]*i,!0)}break;case c.FLOAT:if(s.count===1)e.setFloat32(r+s.offset,t*i,!0);else for(let n=0;n<s.count;n++){const a=n*Float32Array.BYTES_PER_ELEMENT;e.setFloat32(r+s.offset+a,t[n]*i,!0)}}}function G(e,t,s){switch(t.type){case c.BYTE:{if(t.count===1)return e.getInt8(s+t.offset);const r=[];for(let i=0;i<t.count;i++){const n=i*Int8Array.BYTES_PER_ELEMENT;r.push(e.getInt8(s+t.offset+n))}return r}case c.UNSIGNED_BYTE:{if(t.count===1)return e.getUint8(s+t.offset);const r=[];for(let i=0;i<t.count;i++){const n=i*Uint8Array.BYTES_PER_ELEMENT;r.push(e.getUint8(s+t.offset+n))}return r}case c.SHORT:{if(t.count===1)return e.getInt16(s+t.offset,!0);const r=[];for(let i=0;i<t.count;i++){const n=i*Int16Array.BYTES_PER_ELEMENT;r.push(e.getInt16(s+t.offset+n,!0))}return r}case c.UNSIGNED_SHORT:{if(t.count===1)return e.getUint16(s+t.offset,!0);const r=[];for(let i=0;i<t.count;i++){const n=i*Uint16Array.BYTES_PER_ELEMENT;r.push(e.getUint16(s+t.offset+n,!0))}return r}case c.INT:{if(t.count===1)return e.getInt32(s+t.offset,!0);const r=[];for(let i=0;i<t.count;i++){const n=i*Int32Array.BYTES_PER_ELEMENT;r.push(e.getInt32(s+t.offset+n,!0))}return r}case c.UNSIGNED_INT:{if(t.count===1)return e.getUint32(s+t.offset,!0);const r=[];for(let i=0;i<t.count;i++){const n=i*Uint32Array.BYTES_PER_ELEMENT;r.push(e.getUint32(s+t.offset+n,!0))}return r}case c.FLOAT:{if(t.count===1)return e.getFloat32(s+t.offset,!0);const r=[];for(let i=0;i<t.count;i++){const n=i*Float32Array.BYTES_PER_ELEMENT;r.push(e.getFloat32(s+t.offset+n,!0))}return r}}}const m=()=>N.getLogger("esri.views.2d.engine.webgl.Utils");function D(e){switch(e){case f.UNSIGNED_BYTE:return 1;case f.UNSIGNED_SHORT_4_4_4_4:return 2;case f.FLOAT:return 4;default:return void m().error(new T("webgl-utils",`Unable to handle type ${e}`))}}function H(e){switch(e){case f.UNSIGNED_BYTE:return Uint8Array;case f.UNSIGNED_SHORT_4_4_4_4:return Uint16Array;case f.FLOAT:return Float32Array;default:return void m().error(new T("webgl-utils",`Unable to handle type ${e}`))}}function L(e){var s;const t={};for(const r in e){const i=e[r];let n=0;t[r]=i.map(a=>{const o=new U(a.name,a.count,a.type,n,0,a.normalized||!1);return n+=a.count*b(a.type),o}),(s=t[r])==null||s.forEach(a=>a.stride=n)}return t}const R=e=>{const t=new Map;for(const s in e)for(const r of e[s])t.set(r.name,r.location);return t},v=e=>{const t={};for(const s in e){const r=e[s];t[s]=r!=null&&r.length?r[0].stride:0}return t},p=new Map,$=(e,t)=>{if(!p.has(e)){const s=L(t),r={strides:v(s),bufferLayouts:s,attributes:R(t)};p.set(e,r)}return p.get(e)},X=e=>e.includes("data:image/svg+xml");function K(e){const t=[];for(let s=0;s<e.length;s++)t.push(e.charCodeAt(s));return t}function q(e,t,s){const r=new A(t.width,t.height);return r.dataType=t.dataType,t.depth&&(r.depth=t.depth),t.flipped&&(r.flipped=t.flipped),t.hasMipmap&&(r.hasMipmap=t.hasMipmap),r.internalFormat=t.internalFormat,t.isImmutable&&(r.isImmutable=t.isImmutable),t.isOpaque&&(r.isOpaque=t.isOpaque),t.maxAnisotropy&&(r.maxAnisotropy=t.maxAnisotropy),r.pixelFormat=t.pixelFormat,t.preMultiplyAlpha&&(r.preMultiplyAlpha=t.preMultiplyAlpha),t.samplingMode&&(r.samplingMode=t.samplingMode),t.target&&(r.target=t.target),r.uniform=t.uniform,t.unpackAlignment&&(r.unpackAlignment=t.unpackAlignment),t.wrapMode&&(r.wrapMode=t.wrapMode),new x(e,r,s)}function j(e){return"url"in e&&"urlHash"in e?{...e,url:""}:e}class _{constructor(t,s,r,i,n,a,o,u,h=[]){this.entityTexel=t,this.anchorX=s,this.anchorY=r,this.directionX=i,this.directionY=n,this.maxScale=a,this.minScale=o,this.referenceBounds=u,this.bounds=h}serialize(t){t.push(this.entityTexel),t.writeF32(this.anchorX),t.writeF32(this.anchorY),t.writeF32(this.directionX),t.writeF32(this.directionY),t.writeF32(this.maxScale),t.writeF32(this.minScale),this.referenceBounds===null?(t.writeF32(0),t.writeF32(0),t.writeF32(0)):(t.writeF32(this.referenceBounds.size),t.writeF32(this.referenceBounds.offsetX),t.writeF32(this.referenceBounds.offsetY)),I(t,this.bounds)}static deserialize(t){const s=t.readInt32(),r=t.readF32(),i=t.readF32(),n=t.readF32(),a=t.readF32(),o=t.readF32(),u=t.readF32(),h=t.readF32(),w=t.readF32(),F=t.readF32(),g=S(t,B)??[];return new _(s,r,i,n,a,o,u,{size:h,offsetX:w,offsetY:F},g)}}export{j as M,q as T,S as a,$ as b,D as c,H as d,d as e,O as f,C as g,K as j,G as n,l as o,_ as r,y as s,k as t,z as w,X as y};

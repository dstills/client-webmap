import{o as S,l as Z}from"./ResponsiveTheme-DUqyjLJP.js";import{ax as J,oD as K,oE as D,c_ as R,oF as E,oa as N,gu as G,oG as q,oH as Q,oI as ii,bl as ei,f8 as P,oJ as ti}from"./index-nBWeBKPv.js";import{r as v,e as oi,s as ni}from"./ElevationProfile-LINWCxB1.js";import{R as ai,E as si}from"./chartUtilsAm5-CaBQ0syn.js";import{o as li,u as z,_ as ri,b as di,r as ci,x as ui}from"./LineSeries-iU4GVklv.js";import{a2 as b,j as x,c as pi,z as xi}from"./Theme-DEURy4s8.js";import{u as O}from"./Tooltip-BzE7nCOZ.js";import"./memoize-DsJmrG76.js";import"./throttle-jjSnxk80.js";import"./traversalUtils-DmE6QkgJ.js";import"./ElevationQuery-cp6baljX.js";import"./UnitSelect-CDGTdVJo.js";import"./DefaultTheme-Ce2rSGHF.js";import"./ColorSet-CJX-lEaa.js";import"./Tick-n8ORxq6c.js";import"./Button-EErotBzl.js";function fi(i,o,t=10){const e=X(o-i,!1);if(e===0)return[i,o];const n=X(e/(t-1),!0);return[Math.floor(i/n)*n,Math.ceil(o/n)*n]}function X(i,o){const t=Math.floor(Math.log10(i)),e=i/10**t;let n;return n=o?e<1.5?1:e<3?2:e<5?2.5:e<7?5:10:e<=1?1:e<=2?2:e<=3?2.5:e<=5?5:10,n*10**t}const A="#f8f8f8",W="#a9a9a9",g="#323232",mi="line",gi="fill",h=15,m=12,Y=.001,hi=.1,Ai=.02,I={fontFamily:"Avenir Next",paddingBottom:m/2,paddingLeft:0,paddingRight:0,paddingTop:0,axisGridStroke:"#f4f4f4",axisLabelsFontSize:9,axisLabelsFontWeight:"400",axisLabelsColor:W,axisTooltipFontSize:12,axisTooltipBackgroundColor:g,axisTooltipLabelColor:A,axisTooltipPaddingTop:Math.round(m/4),axisTooltipPaddingBottom:Math.round(m/4),axisTooltipPaddingHorizontal:Math.round(h/4),xAxisMinGridDistance:50,xAxisLabelsSpacing:Math.round(m/2),xAxisMinLabelPosition:.05,xAxisMaxLabelPosition:.9,yAxisMinGridDistance:30,yAxisLabelSpacing:Math.round(h/4),yAxisMinLabelPosition:0,yAxisMaxLabelPosition:.8,seriesTooltipFontSize:12,seriesTooltipBackgroundColor:A,seriesTooltipLabelColor:g,seriesFillLighten:.9,seriesTooltipSpacing:m/2,seriesTooltipPaddingVertical:Math.round(h/4),seriesTooltipPaddingHorizontal:Math.round(h/4)},vi={...I,axisGridStroke:g,axisLabelsColor:W,axisTooltipBackgroundColor:g,axisTooltipLabelColor:A,seriesTooltipBackgroundColor:g,seriesTooltipLabelColor:A,seriesFillLighten:-.75},y={minX:void 0,maxX:void 0,minY:void 0,maxY:void 0};async function Qi(i){const o=await ai(i.container);J(i.abortOptions);const t=K(),e=t?vi:I;o.setThemes(t?[S.new(o),Z.new(o)]:[S.new(o)]);const n=D(i.container),a=o.container.children.push(li.new(o,{panX:!0,panY:!0,paddingTop:e.paddingTop,paddingBottom:e.paddingBottom,paddingLeft:n?e.paddingRight:e.paddingLeft,paddingRight:n?e.paddingLeft:e.paddingRight,maxTooltipDistance:0}));a.zoomOutButton.set("forceHidden",!0);const s=a.xAxes.push(z.new(o,{renderer:ri.new(o,{})})),l=a.yAxes.push(z.new(o,{renderer:di.new(o,{})})),c=P(null),r=P("loading"),d={params:i,chart:a,xAxis:s,yAxis:l,seriesInfos:new Map,messages:null,theme:e,pointerIsOver:!1,get state(){return r.value},get data(){return c.value},set data(u){c.value=u}};yi(d),Ti(d),bi(d);const p=R([Ci(d,i.onRangeChange),ki(d,i.onCursorPositionChange),L(o.events.once("frameended",()=>{r.value="ready"})),L(o)]);return{destroy:()=>{p.remove(),r.value="destroyed"},update:u=>{u.data===d.data&&u.messages===d.messages||M(d)||Li(d,u)},zoomOut:()=>V(d)}}function M(i){return i.state==="destroyed"}function bi({chart:i,xAxis:o,yAxis:t}){const e=ci.new(i.root,{behavior:"none",xAxis:o,yAxis:t});e.lineY.set("visible",!1),i.set("cursor",e)}function yi(i){var s;const{chart:o,xAxis:t,theme:e}=i;t.setAll({extraMax:0,extraMin:0,maxDeviation:0,numberFormatter:U(i,"distance"),strictMinMax:!0,strictMinMaxSelection:!0}),t.axisHeader.set("forceHidden",!0);const n=t.get("renderer");n.setAll({inside:!1,minGridDistance:e.xAxisMinGridDistance}),n.labels.template.setAll({centerX:b,centerY:b,fill:x(e.axisLabelsColor),fontFamily:e.fontFamily,fontSize:e.axisLabelsFontSize,fontWeight:e.axisLabelsFontWeight,maxPosition:e.xAxisMaxLabelPosition,minPosition:e.xAxisMinLabelPosition,paddingLeft:0,paddingRight:0,paddingTop:e.xAxisLabelsSpacing});const a=t.set("tooltip",O.new(o.root,{paddingBottom:0,paddingLeft:0,paddingRight:0,paddingTop:0}));(s=a.get("background"))==null||s.setAll({fill:x(e.axisTooltipBackgroundColor),stroke:void 0}),a.label.setAll({fill:x(e.axisTooltipLabelColor),fontFamily:e.fontFamily,fontSize:e.axisTooltipFontSize,paddingBottom:e.axisTooltipPaddingBottom,paddingLeft:e.axisTooltipPaddingHorizontal,paddingRight:e.axisTooltipPaddingHorizontal,paddingTop:e.axisTooltipPaddingTop}),n.grid.template.setAll({strokeOpacity:1,stroke:x(e.axisGridStroke)})}function Ti(i){const{yAxis:o,theme:t}=i;o.setAll({baseValue:v().noDataValue,extraMax:0,extraMin:0,maxDeviation:0,numberFormatter:U(i,"elevation"),strictMinMax:!0,strictMinMaxSelection:!0,tooltip:void 0}),o.axisHeader.set("visible",!1);const e=D(i.params.container),n=o.get("renderer");n.setAll({minGridDistance:t.yAxisMinGridDistance,opposite:e,inside:!0}),n.labels.template.setAll({centerX:b,centerY:pi,fill:x(t.axisLabelsColor),fontFamily:t.fontFamily,fontSize:t.axisLabelsFontSize,fontWeight:t.axisLabelsFontWeight,maxPosition:t.yAxisMaxLabelPosition,minPosition:t.yAxisMinLabelPosition,paddingBottom:0,paddingLeft:e?0:t.yAxisLabelSpacing,paddingRight:e?t.yAxisLabelSpacing:0,paddingTop:0,textAlign:"start"}),n.grid.template.setAll({strokeOpacity:1,stroke:x(t.axisGridStroke)})}function Li(i,o){var l;if(M(i))return;const t=i.data??void 0,e=o.data??void 0;(l=i.chart.get("cursor"))==null||l.set("forceHidden",!(e!=null&&e.refined));const n=t!==e,a=(t==null?void 0:t.effectiveUnits)!==(e==null?void 0:e.effectiveUnits),s=(t==null?void 0:t.uniformScaling)!==(e==null?void 0:e.uniformScaling);i.data=e,i.messages=o.messages,(n||a)&&(Mi(i),Pi(i)),s&&V(i),T(i)}function V(i){M(i)||(i.xAxis.zoom(0,1),i.yAxis.zoom(0,1))}function Mi(i){const{chart:o,data:t,xAxis:e,yAxis:n}=i,{minX:a,maxX:s,minY:l,maxY:c}=Fi({data:t,pixelWidth:e.width(),pixelHeight:n.height()}),r=!!(t!=null&&t.uniformScaling),d=!!(t!=null&&t.refined);o.setAll({panX:!0,panY:r,pinchZoomX:d,pinchZoomY:d&&r,wheelX:"panX",wheelY:d?r?"zoomXY":"zoomX":"none"}),e.setAll({max:s,min:a,panX:!0,panY:!1,zoomX:!0,zoomY:r}),n.setAll({max:c,min:l,panX:!1,panY:r,zoomX:r,zoomY:r})}function Fi({data:i,pixelWidth:o,pixelHeight:t}){if(i==null)return y;const e=i.statistics,n=0,a=e==null?void 0:e.maxDistance;let s=e==null?void 0:e.minElevation,l=e==null?void 0:e.maxElevation;if(a==null||s==null||l==null)return y;const c=Math.max(a-n,Y);let r=Math.max(l-s,Y);const d=i.effectiveUnits;if(i.dynamicElevationRange){const p=E(c,d.distance,d.elevation);r=Math.max(r,p/v().maxChartRatio)}return s-=Ai*r,l=s+r+hi*r,[s,l]=fi(s,l,10),r=l-s,i.uniformScaling?Si({data:i,bounds:{minX:n,maxX:a,minY:s,maxY:l},pixelWidth:o,pixelHeight:t,centered:!0}):{minX:n,maxX:n+c,minY:s,maxY:s+r}}function Si({data:i,bounds:o,pixelWidth:t,pixelHeight:e,centered:n}){if(i==null)return o;let{minX:a,maxX:s,minY:l,maxY:c}=o;if(a==null||s==null||l==null||c==null)return y;const r=s-a,d=c-l,p=i.effectiveUnits,u=E(d,p.elevation,p.distance)/e/(r/t);return u>=1?[a,s]=C([a,s],u,n):[l,c]=C([l,c],1/u,n),{minX:a,maxX:s,minY:l,maxY:c}}function C([i,o],t,e){const n=(o-i)*t;if(e){const a=(i+o)/2-n/2;return[a,a+n]}return[i,i+n]}function Pi(i){var r;const{chart:o,data:t,seriesInfos:e,xAxis:n,yAxis:a}=i;if(t==null||t.lines.length===0)return void o.series.clear();const s=new Map,l=new Set(o.series.values),c=t.lines.length;for(let d=0;d<c;d++){const p=t.lines[d];let u=e.get(p.id);u?(u.fill&&l.delete(u.fill),l.delete(u.line)):(u=Xi(i,p),u.fill&&o.series.push(u.fill),o.series.push(u.line)),s.set(u.id,u);const f=c-d-1;(r=u.fill)==null||r.set("layer",f),u.line.set("layer",c+f),zi(i,u,p)}i.seriesInfos=s;for(const d of l)o.series.removeValue(d);n.set("layer",c+1),a.set("layer",c+2)}function zi({theme:i},o,t){const e=x(t.color.toCss()),n=t.samples??[],a=n.length>0,{line:s,fill:l}=o;s.set("visible",a),s.set("stroke",e),l==null||l.set("visible",a),l==null||l.set("fill",xi.lighten(e,i.seriesFillLighten)),s.data.setAll(n),l==null||l.data.setAll(n)}function Xi(i,o){const{id:t}=o,e=k(i,`${mi}-${t}`);e.setAll({dy:o.chartStrokeOffsetY,tooltip:Yi(i)}),e.strokes.template.setAll({strokeWidth:o.chartStrokeWidth});let n=null;return o.chartFillEnabled&&(n=k(i,`${gi}-${t}`),n.fills.template.setAll({fillOpacity:1,visible:!0})),{id:t,line:e,fill:n}}function k(i,o){return ui.new(i.chart.root,{connect:!1,excludeFromTotal:!0,fill:void 0,id:o,stroke:void 0,valueXField:"distance",valueYField:"elevation",xAxis:i.xAxis,yAxis:i.yAxis})}function Yi({theme:i,chart:o}){var a;const t=O.new(o.root,{autoTextColor:!1,forceHidden:!0,getFillFromSprite:!1,getLabelFillFromSprite:!1,pointerOrientation:"vertical",visible:!1}),e=i.seriesTooltipPaddingHorizontal,n=i.seriesTooltipPaddingVertical;return t.label.setAll({fill:x(i.seriesTooltipLabelColor),fontFamily:i.fontFamily,fontSize:i.seriesTooltipFontSize,paddingBottom:n,paddingLeft:e,paddingRight:e,paddingTop:n,textAlign:"start"}),(a=t.get("background"))==null||a.setAll({stroke:void 0,fill:x(i.seriesTooltipBackgroundColor)}),t.adapters.add("dy",s=>{var r;const l=i.seriesTooltipSpacing,c=((r=t.get("pointTo"))==null?void 0:r.y)??0;return(s??0)+(t.y()>c?l:-l)}),t}function Ci(i,o){const{xAxis:t,yAxis:e}=i,n=()=>{o(w(t),w(e))},a=s=>[s.on("start",n),s.on("end",n)];return _([...a(t),...a(e)])}function w(i){const o=Math.abs((i.get("end")??0)-(i.get("start")??0)),t=o!==0?1/o:1;return Math.abs(1-t)<ti()?1:t}function ki(i,o){const{chart:t,xAxis:e,yAxis:n}=i,a=t.get("cursor"),s=t.plotContainer.events,l=r=>{i.pointerIsOver=r,T(i)},c=()=>{l(!1),o(null,null)};return _([a==null?void 0:a.events.on("cursormoved",()=>{if(!i.pointerIsOver)return;T(i);let r=(a==null?void 0:a.getPrivate("positionX"))??0,d=(a==null?void 0:a.getPrivate("positionY"))??0;const p=i.data;if((p==null?void 0:p.statistics)!=null){const{maxDistance:u,minElevation:f,maxElevation:F}=p.statistics;u!=null&&(r=H(r,$(e),B(e),0,u)),f!=null&&F!=null&&(d=H(d,$(n),B(n),f,F))}o(r,d)}),s.on("pointerover",()=>l(!0)),s.on("pointerout",c),s.on("blur",c)])}function H(i,o,t,e,n){return(o+i*(t-o)-e)/(n-e)}function T(i){const o=wi(i);if(!o)return void i.seriesInfos.forEach(t=>{var e;(e=t.line.get("tooltip"))==null||e.set("forceHidden",!0)});i.seriesInfos.forEach(t=>{const e=t.line.get("tooltip");e.set("forceHidden",!1),e.label.set("text",o)}),i.xAxis.getTooltip().setAll({tooltipText:Bi(i)})}function wi(i){const{data:o}=i,t=o==null?void 0:o.lines.map(e=>{var n;return{line:e,y:(n=j(i,e))==null?void 0:n.elevation}}).sort(Hi);return t&&t.length!==0&&t[0].y!=null?t.map(({y:e,line:n})=>$i(i,n,e)).join(`
`):null}function Hi({y:i},{y:o}){return i==null?1:o==null?-1:o-i}function $i(i,o,t){const{data:e,messages:n}=i;if(e==null||n==null)return"";const a=v().formatPrecision,s=N(n.chartTooltip,{name:oi(o,n),elevation:t!=null?G(n,t,e.effectiveUnits.elevation,a):ni});return`[${o.color.toHex()}]●[/] ${s}`}function Bi(i){const{data:o,messages:t}=i;if(o==null||t==null)return"";const e=o.lines[0],n=e?j(i,e):null,a=v().formatPrecision;return n!=null?G(t,n.distance,o.effectiveUnits.distance,a):"-"}function U(i,o){const t=si.new(i.chart.root,{});return t.format=(e,n,a)=>{const{data:s,messages:l}=i;return l==null||s==null||typeof e=="string"?"":`${q(e,{maximumFractionDigits:a})} ${Q(l,s.effectiveUnits[o],"abbr")}`},t}function j({chart:i,xAxis:o},t){const e=t.samples??[];if(e.length===0)return null;const n=i.get("cursor"),a=(n==null?void 0:n.getPrivate("positionX"))??0,s=o.toAxisPosition(a),l=o.positionToValue(s);return ii(e,l,c=>c.distance)}function $(i){return i.positionToValue(i.get("start")??0)}function B(i){return i.positionToValue(i.get("end")??1)}function _(i){return R(i.map(L))}function L(i){return ei(()=>{i==null||i.dispose()})}export{Qi as createChart,Fi as getAdjustedBounds};

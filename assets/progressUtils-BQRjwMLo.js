import{aj as i,e7 as m,am as u,nz as h,ao as l,nA as p}from"./index-BS4ejk0L.js";const b={upload:{createFromFiles:.8,loadMesh:.2},uploadAssetBlobs:{prepareAssetItems:.9,uploadAssetItems:.1},uploadConvertibleSource:{uploadEditSource:.5,serviceAssetsToGlb:.5},uploadLocalMesh:{meshToAssetBlob:.5,uploadAssetBlobs:.5}};function T(r,s=t=>{},e){return new g(r,s,e)}class g{constructor(s,e=o=>{},t){if(this.onProgress=e,this.taskName=t,this._progressMap=new Map,this._startTime=void 0,this._timingsMap=new Map,typeof s=="number"){this._weights={};for(let o=0;o<s;o++){const n=o,a=1/s;this._weights[n]=a,this._progressMap.set(n,0)}}else this._weights=s;this.emitProgress()}emitProgress(){let s=0;for(const[e,t]of this._progressMap.entries())s+=t*this._weights[e];if(s===1&&i("enable-feature:esri-3dofl-upload-timings")){const e=Math.round(performance.now()-(this._startTime??0))/1e3;console.log(`${this.taskName} done in ${e} sec`);for(const[t,o]of this._timingsMap){const n=Math.round(o.end-o.start)/1e3,a=Math.round(n/e*100);console.log(this.taskName??"Task",{stepKey:t,stepTime:n,relativeTime:a})}}this.onProgress(s)}setProgress(s,e){if(this._progressMap.set(s,e),i("enable-feature:esri-3dofl-upload-timings")){const t=performance.now();this._startTime??(this._startTime=t);const o=m(this._timingsMap,s,()=>({start:t,end:0}));e===1&&(o.end=t)}this.emitProgress()}simulate(s,e){return f(t=>this.setProgress(s,t),e)}makeOnProgress(s){return e=>this.setProgress(s,e)}}function f(r=e=>{},s=w){const e=performance.now();r(0);const t=setInterval(()=>{const o=performance.now()-e,n=1-Math.exp(-o/s);r(n)},_);return u(()=>{clearInterval(t),r(1)})}function A(r,s=d){return h(p(r*c/s))}function $(r,s=M){return h(p(r*c/s))}const d=10,M=10,c=8e-6,_=l(50),w=l(1e3);export{f as a,b as e,A as h,T as i,$ as m};

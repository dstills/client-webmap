function __vite__mapDeps(indexes) {
  if (!__vite__mapDeps.viteFileDeps) {
    __vite__mapDeps.viteFileDeps = ["assets/calcite-action-BTM0fbsv.js","assets/index-BS4ejk0L.js","assets/index-DvE0Cji0.css","assets/calcite-button-BEiwyGvk.js","assets/button-CTlumxno.js","assets/calcite-chip-group-D_tqtFi7.js","assets/calcite-chip-DRgZAh8H.js","assets/chip-BpprsELZ.js","assets/calcite-fab-CT311ONK.js","assets/calcite-flow-DRly-jeA.js","assets/calcite-flow-item-DZI_Ti_u.js","assets/panel-DuhNxSOG.js","assets/calcite-icon-BkHotFMP.js","assets/calcite-input-QgysYMCD.js","assets/input2-CDCfA0lA.js","assets/Validation-Pfa6caJE.js","assets/input-kBVpmtEZ.js","assets/input-message-CuciggWc.js","assets/progress-B2N2lbwf.js","assets/calcite-input-message-C1DV76vZ.js","assets/calcite-label-CumKmLeQ.js","assets/calcite-list-DBGYLCXn.js","assets/utils3-C4KfsP4-.js","assets/filter-C2cemdNK.js","assets/calcite-list-item-CwXGdoVL.js","assets/calcite-loader-MUF21uuE.js","assets/calcite-notice-C1QyOSTw.js","assets/calcite-scrim-De915RLe.js","assets/calcite-switch-CtAlbgd2.js","assets/calcite-table-CrRx8htD.js","assets/calcite-table-cell-C88HSzNi.js","assets/table-cell-Dl5jf89P.js","assets/calcite-table-header-0hXMFHQm.js","assets/table-header-B-fe40zk.js","assets/calcite-table-row-BolUkIje.js"]
  }
  return indexes.map((i) => __vite__mapDeps.viteFileDeps[i])
}
import{E as n,F as l,J as D,O as Z,be as Q,rR as G,ja as W,c6 as X,lm as w,aT as f,b as y,rS as x,nK as Y,gm as V,c3 as tt,j0 as P,nL as et,j1 as ot,j2 as it,_ as k,j3 as r,nF as C,pZ as at,A as rt,rT as nt,cb as q,cd as H,q9 as j}from"./index-BS4ejk0L.js";let v=class extends Z{constructor(e){super(e)}get editedBookmark(){const{bookmark:e}=this;return e?this._get("editedBookmark")||e.clone():null}get customUrl(){var e,o,i,a;return(o=(e=this.editedBookmark)==null?void 0:e.thumbnail)!=null&&o.isSecureUrl?(a=(i=this.editedBookmark)==null?void 0:i.thumbnail)==null?void 0:a.url:null}set customUrl(e){this._override("customUrl",e)}get screenshotUrl(){var e,o,i,a;return(o=(e=this.editedBookmark)==null?void 0:e.thumbnail)!=null&&o.isDataURI?(a=(i=this.editedBookmark)==null?void 0:i.thumbnail)==null?void 0:a.url:null}set screenshotUrl(e){this._override("screenshotUrl",e)}get state(){return this._get("state")}set state(e){this.validationState=void 0,this.loading=void 0,this._set("state",e)}get thumbnailState(){var e,o,i,a;return(o=(e=this.editedBookmark)==null?void 0:e.thumbnail)!=null&&o.url?(a=(i=this.editedBookmark)==null?void 0:i.thumbnail)!=null&&a.isSecureUrl?"url":"screenshot":"none"}set thumbnailState(e){this._overrideIfSome("thumbnailState",e)}};n([l()],v.prototype,"bookmark",void 0),n([l({readOnly:!0})],v.prototype,"editedBookmark",null),n([l()],v.prototype,"customUrl",null),n([l()],v.prototype,"screenshotUrl",null),n([l()],v.prototype,"state",null),n([l()],v.prototype,"thumbnailState",null),n([l()],v.prototype,"validationState",void 0),n([l()],v.prototype,"loading",void 0),v=n([D("esri.widgets.Bookmarks.UserState")],v);const F=v,z=Q.ofType(G),lt={width:128,height:128,format:"png"},A={takeScreenshot:!0,captureViewpoint:!0,captureRotation:!0,captureScale:!0,captureTimeExtent:!0},L={time:!0};let b=class extends W(X.EventedAccessor){constructor(t){super(t),this.capabilities={...L},this.activeBookmark=null,this.view=null}destroy(){this.view=null,this._set("activeBookmark",null)}get abilities(){return w(f.getLogger(this),"abilities",{replacement:"capabilities",version:"4.27"}),this.capabilities}set abilities(t){w(f.getLogger(this),"abilities",{replacement:"capabilities",version:"4.27"}),this.capabilities=t}castAbilities(t){return{...L,...t}}castCapabilities(t){return{...L,...t}}get bookmarks(){var t,e;return((e=(t=this.view)==null?void 0:t.map)==null?void 0:e.bookmarks)??new z}set bookmarks(t){this._overrideIfSome("bookmarks",t)}set defaultCreateOptions(t){this._set("defaultCreateOptions",{...A,...t})}get defaultCreateOptions(){return A}set defaultEditOptions(t){this._set("defaultEditOptions",{...A,...t})}get defaultEditOptions(){return A}get state(){const{view:t}=this;return t&&!t.ready?"loading":"ready"}async createBookmark(t){const{view:e,defaultCreateOptions:o,capabilities:i}=this;if(!e)throw new y("create-bookmark:invalid-view","Cannot create a bookmark without a view.");const{takeScreenshot:a,screenshotSettings:s,captureViewpoint:m,captureRotation:c,captureScale:_,captureTimeExtent:B}={...o,...t},h=a?await this._createThumbnail(s):void 0,E=i.time&&B&&e.timeExtent!=null?e.timeExtent.clone():void 0;return new G({...h&&{thumbnail:h},...B&&{timeExtent:E},...m&&{viewpoint:this._createViewpoint({view:e,captureScale:_,captureRotation:c})}})}async editBookmark(t,e){if(!t)return t;const{view:o,defaultEditOptions:i}=this;if(!o)throw new y("edit-bookmark:invalid-view","Cannot edit a bookmark without a view.");const{takeScreenshot:a,screenshotSettings:s,captureViewpoint:m,captureRotation:c,captureScale:_,captureTimeExtent:B}={...i,...e},h=a?await this._createThumbnail(s):void 0;return h&&(t.thumbnail=h),m&&(t.viewpoint=this._createViewpoint({view:o,captureScale:_,captureRotation:c})),B&&o.timeExtent!=null&&(t.timeExtent=o.timeExtent.clone()),this.emit("bookmark-edit",{bookmark:t}),t}goTo(t){const{capabilities:e,view:o}=this;if(!o)throw new y("go-to:invalid-view","Cannot go to a bookmark without a view");const i=t==null?void 0:t.viewpoint;if(!i)throw new y("go-to:invalid-bookmark","Cannot go to a bookmark that does not contain a 'viewpoint'.",{bookmark:t});this._set("activeBookmark",t);const a={target:i},s=this.callGoTo(a),m=t==null?void 0:t.timeExtent;return e.time&&m&&(o.timeExtent=m),this.emit("bookmark-select",{bookmark:t}),s.catch(()=>{}).then(()=>this._set("activeBookmark",null)),s}async _createThumbnail(t){const{view:e}=this;if(!e)throw new y("bookmark:invalid-view","Cannot create slide thumbnail without a view");const o=await e.takeScreenshot({...lt,...t});return new x({url:o.dataUrl})}_createViewpoint({view:t,captureRotation:e,captureScale:o}){var a,s;const i=(a=t.viewpoint)==null?void 0:a.clone();return new Y({targetGeometry:(s=t.extent)==null?void 0:s.clone(),rotation:(e?i==null?void 0:i.rotation:null)??0,scale:(o?i==null?void 0:i.scale:null)??0})}};n([l()],b.prototype,"abilities",null),n([V("abilities")],b.prototype,"castAbilities",null),n([l()],b.prototype,"capabilities",void 0),n([V("capabilities")],b.prototype,"castCapabilities",null),n([l({readOnly:!0})],b.prototype,"activeBookmark",void 0),n([l({type:z})],b.prototype,"bookmarks",null),n([l()],b.prototype,"defaultCreateOptions",null),n([l()],b.prototype,"defaultEditOptions",null),n([l({readOnly:!0})],b.prototype,"state",null),n([l()],b.prototype,"view",void 0),b=n([D("esri.widgets.Bookmarks.BookmarksViewModel")],b);const J=b;let g=class extends Z{constructor(){super(...arguments),this.addBookmarkButton=!1,this.closeButton=!1,this.collapseButton=!1,this.editBookmarkButton=!1,this.filter=!1,this.flow=!0,this.heading=!1,this.thumbnail=!0,this.time=!0}get addBookmark(){return w(f.getLogger(this),"addBookmark",{replacement:"addBookmarkButton",version:"4.29",warnOnce:!0}),this.addBookmarkButton}set addBookmark(e){w(f.getLogger(this),"addBookmark",{replacement:"addBookmarkButton",version:"4.29",warnOnce:!0}),this.addBookmarkButton=e}};n([l({type:Boolean,nonNullable:!0})],g.prototype,"addBookmark",null),n([l({type:Boolean,nonNullable:!0})],g.prototype,"addBookmarkButton",void 0),n([l({type:Boolean,nonNullable:!0})],g.prototype,"closeButton",void 0),n([l({type:Boolean,nonNullable:!0})],g.prototype,"collapseButton",void 0),n([l({type:Boolean,nonNullable:!0})],g.prototype,"editBookmarkButton",void 0),n([l({type:Boolean,nonNullable:!0})],g.prototype,"filter",void 0),n([l({type:Boolean,nonNullable:!0})],g.prototype,"flow",void 0),n([l({type:Boolean,nonNullable:!0})],g.prototype,"heading",void 0),n([l({type:Boolean,nonNullable:!0})],g.prototype,"thumbnail",void 0),n([l({type:Boolean,nonNullable:!0})],g.prototype,"time",void 0),g=n([D("esri.widgets.Bookmarks.BookmarksVisibleElements")],g);const R=g,p="esri-bookmarks",U=`${p}__authoring`,$=`${p}__bookmark`,u={base:p,widgetIcon:tt.bookmark,noBookmarksHeader:`${p}__no-bookmarks-heading`,noBookmarksDescription:`${p}__no-bookmarks-description`,form:`${p}__form`,list:`${p}__list`,loader:`${p}__loader`,filterNoResults:`${p}__filter-no-results`,formContent:`${p}__form-content`,addBookmarkButton:`${p}__add-bookmark-button`,editBookmarkInput:`${p}__edit-bookmark-input`,addBookmarkInput:`${p}__add-bookmark-input`,dragEnabled:`${p}--drag-enabled`,bookmarkImage:`${p}__image`,bookmarkImageContainer:`${$}-image-container`,bookmarkContent:`${$}-content`,bookmarkContentLabel:`${$}-content-label`,authoring:U,authoringImageContainer:`${U}-image-container`,authoringRefreshThumbnailButton:`${U}-refresh-thumbnail-button`},st="esri.widgets.Bookmarks";let d=class extends ot{constructor(t,e){super(t,e),this._addInputNode=null,this._editInputNode=null,this._urlEditInputNode=null,this._lastDragDetail=null,this._selectedDragBookmarkUid=null,this._editIncludeTimeExtent=void 0,this._userState=null,this._focusRootFlowItem=!1,this._focusAddFlowItem=!1,this._focusEditFlowItem=!1,this.disabled=!1,this.dragEnabled=!1,this.filterPlaceholder="",this.filterText="",this.headingLevel=2,this.iconClass=u.widgetIcon,this.icon=null,this.messages=null,this.messagesCommon=null,this.viewModel=new J,this.visibleElements=new R,this._onCalciteListOrderChange=o=>{const{_lastDragDetail:i,bookmarks:a}=this,{toEl:s,fromEl:m,dragEl:c,newIndex:_}=o;if(!a.length||!m||!s||(i==null?void 0:i.newIndex)===_&&(i==null?void 0:i.dragEl)===c&&(i==null?void 0:i.toEl)===s&&(i==null?void 0:i.fromEl)===m)return;this._lastDragDetail=o;const B=Array.from(m.children).filter(h=>h==null?void 0:h.matches("calcite-list-item")).map(h=>h.value);a.sort((h,E)=>{const T=B.indexOf(h.uid),S=B.indexOf(E.uid);return T>S?1:T<S?-1:0})}}normalizeCtorArgs(t){return(t==null?void 0:t.editingEnabled)!=null&&t.visibleElements!=null?{...t,visibleElements:new R({...t.visibleElements,addBookmarkButton:t.editingEnabled,editBookmarkButton:t.editingEnabled})}:t}loadDependencies(){return it({action:()=>k(()=>import("./calcite-action-BTM0fbsv.js"),__vite__mapDeps([0,1,2])),button:()=>k(()=>import("./calcite-button-BEiwyGvk.js"),__vite__mapDeps([3,4,1,2])),"chip-group":()=>k(()=>import("./calcite-chip-group-D_tqtFi7.js"),__vite__mapDeps([5,1,2])),chip:()=>k(()=>import("./calcite-chip-DRgZAh8H.js"),__vite__mapDeps([6,7,1,2])),fab:()=>k(()=>import("./calcite-fab-CT311ONK.js"),__vite__mapDeps([8,1,2,4])),flow:()=>k(()=>import("./calcite-flow-DRly-jeA.js"),__vite__mapDeps([9,1,2])),"flow-item":()=>k(()=>import("./calcite-flow-item-DZI_Ti_u.js"),__vite__mapDeps([10,1,2,11])),icon:()=>k(()=>import("./calcite-icon-BkHotFMP.js"),__vite__mapDeps([12,1,2])),input:()=>k(()=>import("./calcite-input-QgysYMCD.js"),__vite__mapDeps([13,14,1,2,15,16,17,18])),"input-message":()=>k(()=>import("./calcite-input-message-C1DV76vZ.js"),__vite__mapDeps([19,17,1,2])),label:()=>k(()=>import("./calcite-label-CumKmLeQ.js"),__vite__mapDeps([20,1,2])),list:()=>k(()=>import("./calcite-list-DBGYLCXn.js"),__vite__mapDeps([21,1,2,22,23,14,15,16,17,18])),"list-item":()=>k(()=>import("./calcite-list-item-CwXGdoVL.js"),__vite__mapDeps([24,1,2,22])),loader:()=>k(()=>import("./calcite-loader-MUF21uuE.js"),__vite__mapDeps([25,1,2])),notice:()=>k(()=>import("./calcite-notice-C1QyOSTw.js"),__vite__mapDeps([26,1,2])),scrim:()=>k(()=>import("./calcite-scrim-De915RLe.js"),__vite__mapDeps([27,1,2])),switch:()=>k(()=>import("./calcite-switch-CtAlbgd2.js"),__vite__mapDeps([28,1,2])),table:()=>k(()=>import("./calcite-table-CrRx8htD.js"),__vite__mapDeps([29,1,2,4,7])),"table-cell":()=>k(()=>import("./calcite-table-cell-C88HSzNi.js"),__vite__mapDeps([30,31,1,2])),"table-header":()=>k(()=>import("./calcite-table-header-0hXMFHQm.js"),__vite__mapDeps([32,33,1,2])),"table-row":()=>k(()=>import("./calcite-table-row-BolUkIje.js"),__vite__mapDeps([34,1,2,31,33]))})}get defaultCreateOptions(){return this.viewModel.defaultCreateOptions}set defaultCreateOptions(t){this.viewModel.defaultCreateOptions=t}get defaultEditOptions(){return this.viewModel.defaultEditOptions}set defaultEditOptions(t){this.viewModel.defaultEditOptions=t}get bookmarks(){return this.viewModel.bookmarks}set bookmarks(t){this.viewModel.bookmarks=t}get editingEnabled(){return w(f.getLogger(this),"editingEnabled",{replacement:"dragEnabled, visibleElements.editBookmarkButton, visibleElements.addBookmarkButton",version:"4.29",warnOnce:!0}),this.dragEnabled&&this.visibleElements.editBookmarkButton&&this.visibleElements.addBookmarkButton}set editingEnabled(t){w(f.getLogger(this),"editingEnabled",{replacement:"dragEnabled, visibleElements.editBookmarkButton, visibleElements.addBookmarkButton",version:"4.29",warnOnce:!0}),this.dragEnabled=t,this.visibleElements.editBookmarkButton=t,this.visibleElements.addBookmarkButton=t}get goToOverride(){return this.viewModel.goToOverride}set goToOverride(t){this.viewModel.goToOverride=t}get label(){var t;return((t=this.messages)==null?void 0:t.widgetLabel)??""}set label(t){this._overrideIfSome("label",t)}get view(){return this.viewModel.view}set view(t){this.viewModel.view=t}endAddBookmark(){this._userState=null}goTo(t){return this.viewModel.goTo(t)}render(){return r("div",{class:this.classes(u.base,C.widget,C.panel)},this._renderBookmarksContainer())}startAddBookmark(){this._userState=new F({state:"add"}),this._focusAddFlowItem=!0}_renderNoBookmarksContainer(t){const{messages:e,viewModel:{state:o}}=this;return t.length||o==="loading"?null:r("div",{class:C.empty,key:"no-bookmarks"},r("calcite-icon",{icon:"bookmark",scale:"l"}),r(at,{class:this.classes(C.heading,u.noBookmarksHeader),level:this.headingLevel},e==null?void 0:e.noBookmarksHeading),r("p",{class:u.noBookmarksDescription},e.noBookmarksDescription))}_renderEditBookmarkFlowItems(){const{_userState:t}=this,e=t==null?void 0:t.editedBookmark;return e&&(t==null?void 0:t.state)==="edit"?this._renderEditingBookmark(e):[]}_renderBookmarkItems(t){return t?t.toArray().map(e=>this._renderBookmark(e)):[]}_handleCalciteListDragEnd(t){const{fromEl:e,dragEl:o,oldIndex:i}=t;e.insertBefore(o,e.children[i])}_renderBookmarksContainer(){const{viewModel:{state:t,bookmarks:e},dragEnabled:o,messages:i,disabled:a,filterPlaceholder:s,filterText:m,visible:c,headingLevel:_,visibleElements:{closeButton:B,collapseButton:h,filter:E,heading:T,flow:S}}=this,O=e.filter(rt),K=O.length?r("calcite-list",{class:u.list,dragEnabled:o,filterEnabled:E,filterPlaceholder:s,filterText:m,group:"root-bookmarks",key:"bookmark-list",label:i.widgetLabel,selectionAppearance:"border",selectionMode:"none",onCalciteListDragEnd:I=>this._handleCalciteListDragEnd(I.detail),onCalciteListFilter:I=>{var M;return this.filterText=((M=I.target)==null?void 0:M.filterText)??""},onCalciteListOrderChange:I=>this._onCalciteListOrderChange(I.detail)},this._renderBookmarkItems(O),E?r("div",{class:u.filterNoResults,slot:"filter-no-results"},r("calcite-notice",{kind:"info",open:!0,width:"full"},r("div",{slot:"message"},i.noBookmarksHeading),";")):null):null,N=[r("calcite-flow-item",{afterCreate:this._focusRootFlowItemNode,afterUpdate:this._focusRootFlowItemNode,bind:this,closable:B,closed:!c,collapsible:h,disabled:a,heading:T?i.widgetLabel:void 0,headingLevel:_,loading:t==="loading",onCalciteFlowItemClose:()=>this.visible=!1},this._renderNoBookmarksContainer(O),K,this._renderAddBookmarkButton()),this._renderAddingBookmark(),this._renderEditBookmarkFlowItems()];return c?S?r("calcite-flow",{key:"root-flow"},N):N:null}_renderAddBookmarkButton(){const{messages:t,_userState:e,disabled:o,viewModel:{view:i,state:a},visibleElements:{addBookmarkButton:s}}=this,m=(e==null?void 0:e.loading)??!1;return i&&a!=="loading"&&s?r("calcite-fab",{appearance:"outline-fill",bind:this,class:u.addBookmarkButton,disabled:o||m,icon:"plus",key:"add-bookmark-item",kind:"neutral",loading:m,onclick:this.startAddBookmark,slot:"fab",text:t.addBookmark,textEnabled:!0,title:t.addBookmark,type:"button"}):null}_renderEditContainer(t){const{messagesCommon:e,visibleElements:{editBookmarkButton:o}}=this,i=this._getBookmarkTitle(t);return o?r("calcite-action",{appearance:"transparent",icon:"pencil",key:"edit-action",onclick:()=>this._showEditBookmarkForm(t),slot:"actions-end",text:`${e.edit} ${i}`,title:`${e.edit} ${i}`}):null}_renderBookmarkImage(t,e){var o;return e?r("img",{alt:"",class:u.bookmarkImage,key:"bookmark-image",src:(o=t.thumbnail)==null?void 0:o.url}):null}_renderBookmarkTimeSwitch(t){const{messages:e,viewModel:{view:o}}=this,{timeExtent:i}=t;return(o==null?void 0:o.timeExtent)??i?r("calcite-label",{layout:"inline-space-between"},e.includeTimeExtent,r("calcite-switch",{checked:!!i,onCalciteSwitchChange:a=>{this._editIncludeTimeExtent=!!a.target.checked}})):null}_renderEditBookmarkTimeExtent(t){return this._editIncludeTimeExtent?this._renderBookmarkTimeExtent(t):null}_getTimeExtentStrings(t){const{visibleElements:e}=this,{timeExtent:o}=t;if(!o)return{};const{start:i,end:a}=o,s=a!=null&&(i==null||i.getTime()!==a.getTime()),m=i?this._formatDate(i):"",c=i&&e.time?this._formatTime(i):"";return s?{startDate:m,startTime:c,endDate:this._formatDate(a),endTime:e.time?this._formatTime(a):""}:{startDate:m,startTime:c}}_renderTimeExtentDescription(t){const{startDate:e,startTime:o,endDate:i,endTime:a}=this._getTimeExtentStrings(t);if(!e)return"";const s=`${e} ${o}`;return i?`${s} - ${`${i} ${a}`}`:s}_renderBookmarkTimeExtent(t,e=!1){const{messages:o}=this,{startDate:i,startTime:a,endDate:s,endTime:m}=this._getTimeExtentStrings(t),c=e?null:r("calcite-table-row",{slot:"table-header"},r("calcite-table-header",{heading:o.startDate}),s?r("calcite-table-header",{heading:o.endDate}):null);return i?r("calcite-table",{caption:o.timeExtent,scale:"s"},c,r("calcite-table-row",null,r("calcite-table-cell",null,i," ",a?[r("br",null),a]:null),s?r("calcite-table-cell",null,s,m?[r("br",null),m]:null):null)):null}_renderBookmarkActiveScrim(t,e){return this.viewModel.activeBookmark===t&&e?r("calcite-scrim",{key:"bookmark-active-scrim",loading:!0}):null}_renderBookmarkActiveLoader(t,e){return this.viewModel.activeBookmark!==t||e?null:r("calcite-loader",{class:u.loader,inline:!0,key:"bookmark-active-loader",label:this.messagesCommon.loading,scale:"m"})}_renderBookmarkImageIcon(t,e){return this.viewModel.activeBookmark===t||e?null:r("calcite-icon",{icon:"bookmark",key:"bookmark-icon",scale:"s"})}_renderBookmarkThumbnail(t){var o;const e=this.visibleElements.thumbnail&&!!((o=t.thumbnail)!=null&&o.url);return r("div",{class:u.bookmarkImageContainer,slot:"content-start"},this._renderBookmarkActiveScrim(t,e),this._renderBookmarkImage(t,e),this._renderBookmarkActiveLoader(t,e),this._renderBookmarkImageIcon(t,e))}_focusSelectedDragEl(t,e){this._selectedDragBookmarkUid===e.uid&&requestAnimationFrame(()=>t==null?void 0:t.setFocus())}_handleCalciteListItemDragHandleChange(t,e){t.stopPropagation();const o=t.target.dragSelected;this._selectedDragBookmarkUid=o?e.uid:null}_renderBookmark(t){return r("calcite-list-item",{afterCreate:e=>this._focusSelectedDragEl(e,t),afterUpdate:e=>this._focusSelectedDragEl(e,t),class:this.classes({[u.dragEnabled]:this.dragEnabled}),description:this._renderTimeExtentDescription(t),dragSelected:t.uid===this._selectedDragBookmarkUid,key:t.uid,label:this._getBookmarkTitle(t),value:t.uid,onCalciteListItemDragHandleChange:e=>this._handleCalciteListItemDragHandleChange(e,t),onCalciteListItemSelect:()=>this._goToBookmark(t)},this._renderBookmarkThumbnail(t),this._renderBookmarkContent(t),this._renderEditContainer(t))}_renderBookmarkContent(t){return r("div",{class:u.bookmarkContent,slot:"content"},r("span",{class:u.bookmarkContentLabel},this._getBookmarkTitle(t)),this._renderBookmarkTimeExtent(t,!0))}_renderEditingBookmarkName(t){const{messages:e,_userState:o}=this,i=(o==null?void 0:o.validationState)==="name-required";return r("calcite-label",null,e.title,r("calcite-input",{afterCreate:this._storeEditInput,bind:this,class:u.editBookmarkInput,name:"bookmark-name",placeholder:e.titlePlaceholder,required:!0,type:"text",value:t.name}),i?r("calcite-input-message",{icon:"exclamation-mark-triangle",status:"invalid"},e.invalidTitle):null)}_renderEditingBookmarkActions(){const{messagesCommon:t,_userState:e}=this,o=e==null?void 0:e.bookmark;return[r("calcite-button",{appearance:"transparent",kind:"danger",onclick:()=>this._deleteBookmark(o),slot:"footer",type:"button",width:"full"},t.delete),r("calcite-button",{appearance:"outline",bind:this,onclick:this._closeEditBookmarkForm,slot:"footer",type:"button",width:"full"},t.cancel),r("calcite-button",{slot:"footer",type:"submit",width:"full"},t.save)]}_handleUrlEditInputChange(){var a,s;const{_userState:t,_urlEditInputNode:e}=this,o=e==null?void 0:e.value;if(!(t!=null&&t.editedBookmark)||!o)return;t.validationState=void 0,(a=t.editedBookmark.thumbnail)!=null&&a.isDataURI&&(t.screenshotUrl=(s=t.editedBookmark.thumbnail)==null?void 0:s.url);const i=new x({url:o});i.isSecureUrl&&(t.customUrl=o,t.editedBookmark.thumbnail=i)}_renderEditingTimeExtent(t){const{capabilities:e,view:o}=this.viewModel,{timeExtent:i}=t;return e.time&&((o==null?void 0:o.timeExtent)??i)?r("div",{key:"edit-bookmark-time-container"},this._renderBookmarkTimeSwitch(t),this._renderEditBookmarkTimeExtent(t)):null}_renderEditingBookmarkImage(t){var a,s;const{_userState:e}=this,o=e==null?void 0:e.thumbnailState,i=(a=t.thumbnail)!=null&&a.isSecureUrl?o==="url":(s=t.thumbnail)!=null&&s.isDataURI?o==="screenshot":null;if(i)return this._renderBookmarkImage(t,i)}_renderEditingThumbnail(t){const{_userState:e,visibleElements:o}=this,i=e==null?void 0:e.thumbnailState;return o.thumbnail&&i!=="none"?r("div",{class:u.authoringImageContainer},this._renderEditingBookmarkImage(t)):null}_renderUpdateThumbnailButton(){const{visibleElements:t,messages:e,_userState:o}=this,i=o==null?void 0:o.thumbnailState;return t.thumbnail&&i==="screenshot"?r("calcite-button",{appearance:"outline",class:u.authoringRefreshThumbnailButton,iconStart:"refresh",key:"update-thumbnail",kind:"neutral",onclick:()=>{this._updateThumbnail()},width:"half"},e.updateThumbnail):null}_renderEditingBookmarkUrlInput(t){var c,_;const{messages:e,_userState:o}=this,i=(c=t.thumbnail)==null?void 0:c.url,a=(_=t.thumbnail)!=null&&_.isSecureUrl?i:void 0,s=i&&(o==null?void 0:o.validationState)==="absolute-url-required";return(o==null?void 0:o.thumbnailState)==="url"?r("calcite-label",{key:"thumbnail-url-input"},r("calcite-input",{afterCreate:this._storeUrlEditInput,bind:this,name:"bookmark-thumbnail-url",pattern:nt,placeholder:e?`https://<${e.imageUrlPlaceholder}>`:void 0,required:!0,title:e.imageUrlTooltip,type:"text",value:a,onCalciteInputChange:this._handleUrlEditInputChange,onCalciteInputInput:this._handleUrlEditInputChange}),s?r("calcite-input-message",{icon:"exclamation-mark-triangle",status:"invalid"},e.invalidImageUrl):null):null}_renderThumbnailSelector(){const{visibleElements:t,messages:e,_userState:o}=this,i=o==null?void 0:o.thumbnailState;return t.thumbnail?r("calcite-label",{key:"thumbnail-chip-group"},e.thumbnail,r("calcite-chip-group",{label:e.thumbnail,selectionMode:"single-persist",onCalciteChipGroupSelect:a=>this._handleThumbnailTypeSelect(a.target.selectedItems[0].value)},r("calcite-chip",{selected:i==="screenshot",value:"screenshot"},e.screenshot),r("calcite-chip",{selected:i==="url",value:"url"},e.url),r("calcite-chip",{selected:i==="none",value:"none"},e.none))):null}_renderEditingBookmark(t){const{disabled:e,messagesCommon:o,headingLevel:i}=this;return t?r("form",{bind:this,class:u.form,disabled:this.disabled,onsubmit:this._editBookmarkSubmit},r("calcite-flow-item",{afterCreate:this._focusEditFlowItemNode,afterUpdate:this._focusEditFlowItemNode,bind:this,disabled:e,heading:o.edit,headingLevel:i,key:"edit-bookmark-form",onCalciteFlowItemBack:a=>{a.preventDefault(),this._closeEditBookmarkForm()}},r("div",{class:u.formContent},r("div",{class:u.authoring},this._renderEditingBookmarkName(t),this._renderThumbnailSelector(),this._renderEditingThumbnail(t),this._renderEditingBookmarkUrlInput(t),this._renderUpdateThumbnailButton(),this._renderEditingTimeExtent(t))),this._renderEditingBookmarkActions())):null}_renderAddingBookmarkName(){const{_userState:t,messages:e}=this,o=(t==null?void 0:t.validationState)==="name-required";return r("calcite-label",null,e.title,r("calcite-input",{afterCreate:this._storeAddInput,bind:this,class:u.addBookmarkInput,name:"bookmark-name",placeholder:e.titlePlaceholder,required:!0,type:"text",value:""}),o?r("calcite-input-message",{icon:"exclamation-mark-triangle",status:"invalid"},e.invalidTitle):null)}_renderAddingBookmarkActions(){const{messagesCommon:t}=this;return[r("calcite-button",{appearance:"outline",bind:this,onclick:this._endAddBookmark,slot:"footer",type:"button",width:"half"},t.cancel),r("calcite-button",{slot:"footer",type:"submit",width:"half"},t.add)]}_renderAddingBookmark(){const{disabled:t,messages:e,headingLevel:o,_userState:i}=this;return(i==null?void 0:i.state)==="add"?r("form",{bind:this,class:u.form,disabled:t,onsubmit:this._addBookmarkSubmitClick},r("calcite-flow-item",{afterCreate:this._focusAddFlowItemNode,afterUpdate:this._focusAddFlowItemNode,bind:this,disabled:t,heading:e.addBookmark,headingLevel:o,key:"add-bookmark-form",onCalciteFlowItemBack:a=>{a.preventDefault(),this._endAddBookmark()}},r("div",{class:u.formContent},this._renderAddingBookmarkName()),this._renderAddingBookmarkActions())):null}_getBookmarkTitle(t){return(t==null?void 0:t.name)||this.messagesCommon.untitled}_formatDate(t){var e;return t?q(t,{...H("short-date"),timeZone:((e=this.viewModel.view)==null?void 0:e.timeZone)??j}):""}_formatTime(t){var e;return t?q(t,{...H("long-time"),timeZone:((e=this.viewModel.view)==null?void 0:e.timeZone)??j}):""}_endAddBookmark(){this.endAddBookmark(),this._focusRootFlowItem=!0}_showEditBookmarkForm(t){t&&(this._editIncludeTimeExtent=!!t.timeExtent,this._userState=new F({bookmark:t,state:"edit"}),this._focusEditFlowItem=!0,this.viewModel.goTo(t))}async _createNewScreenshotUrl(){var e;return((e=(await this.viewModel.createBookmark()).thumbnail)==null?void 0:e.url)??null}_storeCurrentUrl(){var o,i,a,s,m,c;const{_userState:t}=this,e=(i=(o=t==null?void 0:t.editedBookmark)==null?void 0:o.thumbnail)==null?void 0:i.url;e&&((s=(a=t==null?void 0:t.editedBookmark)==null?void 0:a.thumbnail)!=null&&s.isSecureUrl?t.customUrl=e:(c=(m=t==null?void 0:t.editedBookmark)==null?void 0:m.thumbnail)!=null&&c.isDataURI&&(t.screenshotUrl=e))}async _handleThumbnailTypeSelect(t){const{_userState:e}=this;if(!e)return;const{screenshotUrl:o,customUrl:i,editedBookmark:a}=e,s=t==="screenshot"?o??await this._createNewScreenshotUrl():t==="url"&&i?i:null;this._storeCurrentUrl(),a&&s&&(a.thumbnail=new x({url:s})),e.validationState=void 0,e.thumbnailState=t}_closeEditBookmarkForm(){this._userState=null,this._focusRootFlowItem=!0}_addBookmarkSubmitClick(t){t.preventDefault(),this._addBookmarkSubmit()}async _addBookmarkSubmit(){const{_addInputNode:t,_userState:e,viewModel:o,viewModel:{bookmarks:i}}=this;if(!e)return;const a=t?t.value.trim():null;if(!a)return void(e.validationState="name-required");e.loading=!0;const s=await o.createBookmark();s.name=a,i.add(s),this._endAddBookmark()}async _editBookmarkAndClose(t,e){const{viewModel:o,viewModel:{defaultEditOptions:i}}=this;await o.editBookmark(t,{...i,...e}),this._closeEditBookmarkForm()}_editBookmarkSubmit(t){t.preventDefault();const{_editInputNode:e,_userState:o,_editIncludeTimeExtent:i,_urlEditInputNode:a}=this;if(!(o!=null&&o.bookmark)||!o.editedBookmark)return;o.validationState=void 0,o.customUrl=void 0,o.screenshotUrl=void 0;const s=e&&e.value.trim();if(!s)return void(o.validationState="name-required");o.bookmark.name=s,o.bookmark.thumbnail=o.editedBookmark.thumbnail,i||(o.bookmark.timeExtent=null);const m=o.thumbnailState;if(m==="url"&&a){const c=a.value,_=new x({url:c});if(!_.isSecureUrl)return void(o.validationState="absolute-url-required");o.bookmark.thumbnail=_}else m==="none"&&(o.bookmark.thumbnail=null);this._editBookmarkAndClose(o.bookmark,{takeScreenshot:!1,captureTimeExtent:i})}_storeEditInput(t){this._editInputNode=t}_storeAddInput(t){this._addInputNode=t}_storeUrlEditInput(t){this._urlEditInputNode=t}_deleteBookmark(t){this._closeEditBookmarkForm(),t&&this.viewModel.bookmarks.remove(t)}_goToBookmark(t){t&&(this.endAddBookmark(),this.viewModel.goTo(t))}async _updateThumbnail(){const{_userState:t,viewModel:e}=this;t&&(t.validationState=void 0,await e.editBookmark(t.editedBookmark,{takeScreenshot:!0,captureViewpoint:!1,captureRotation:!1,captureScale:!1,captureTimeExtent:!1}))}_focusRootFlowItemNode(t){this._focusRootFlowItem&&(this._focusRootFlowItem=!1,requestAnimationFrame(()=>t==null?void 0:t.setFocus()))}_focusEditFlowItemNode(t){this._focusEditFlowItem&&(this._focusEditFlowItem=!1,requestAnimationFrame(()=>t==null?void 0:t.setFocus()))}_focusAddFlowItemNode(t){this._focusAddFlowItem&&(this._focusAddFlowItem=!1,requestAnimationFrame(()=>t==null?void 0:t.setFocus()))}};n([l()],d.prototype,"_editIncludeTimeExtent",void 0),n([l({type:F})],d.prototype,"_userState",void 0),n([l()],d.prototype,"_focusRootFlowItem",void 0),n([l()],d.prototype,"_focusAddFlowItem",void 0),n([l()],d.prototype,"_focusEditFlowItem",void 0),n([l()],d.prototype,"defaultCreateOptions",null),n([l()],d.prototype,"defaultEditOptions",null),n([l()],d.prototype,"bookmarks",null),n([l()],d.prototype,"disabled",void 0),n([l()],d.prototype,"dragEnabled",void 0),n([l()],d.prototype,"editingEnabled",null),n([l()],d.prototype,"filterPlaceholder",void 0),n([l()],d.prototype,"filterText",void 0),n([l()],d.prototype,"headingLevel",void 0),n([l()],d.prototype,"goToOverride",null),n([l()],d.prototype,"iconClass",void 0),n([l()],d.prototype,"icon",void 0),n([l()],d.prototype,"label",null),n([l(),P("esri/widgets/Bookmarks/t9n/Bookmarks")],d.prototype,"messages",void 0),n([l(),P("esri/t9n/common")],d.prototype,"messagesCommon",void 0),n([l()],d.prototype,"uiStrings",void 0),n([l()],d.prototype,"view",null),n([l({type:J}),et(["select-bookmark","bookmark-edit","bookmark-select"])],d.prototype,"viewModel",void 0),n([l({type:R,nonNullable:!0})],d.prototype,"visibleElements",void 0),n([l()],d.prototype,"endAddBookmark",null),n([l()],d.prototype,"startAddBookmark",null),d=n([D(st)],d);const ct=d;export{ct as default};
